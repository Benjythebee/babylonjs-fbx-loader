(function(nt,G){typeof exports=="object"&&typeof module<"u"?G(exports,require("@babylonjs/core"),require("@babylonjs/loaders"),require("@babylonjs/materials")):typeof define=="function"&&define.amd?define(["exports","@babylonjs/core","@babylonjs/loaders","@babylonjs/materials"],G):(nt=typeof globalThis<"u"?globalThis:nt||self,G(nt["babylonjs-fbx-loader"]={},nt.core))})(this,(function(nt,G){"use strict";var ln={},It={};It.byteLength=Li,It.toByteArray=Zi,It.fromByteArray=$i;for(var Ye=[],Le=[],Oi=typeof Uint8Array<"u"?Uint8Array:Array,Ot="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ct=0,zi=Ot.length;ct<zi;++ct)Ye[ct]=Ot[ct],Le[Ot.charCodeAt(ct)]=ct;Le[45]=62,Le[95]=63;function cn(l){var t=l.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var e=l.indexOf("=");e===-1&&(e=t);var a=e===t?0:4-e%4;return[e,a]}function Li(l){var t=cn(l),e=t[0],a=t[1];return(e+a)*3/4-a}function Pi(l,t,e){return(t+e)*3/4-e}function Zi(l){var t,e=cn(l),a=e[0],u=e[1],o=new Oi(Pi(l,a,u)),d=0,h=u>0?a-4:a,k;for(k=0;k<h;k+=4)t=Le[l.charCodeAt(k)]<<18|Le[l.charCodeAt(k+1)]<<12|Le[l.charCodeAt(k+2)]<<6|Le[l.charCodeAt(k+3)],o[d++]=t>>16&255,o[d++]=t>>8&255,o[d++]=t&255;return u===2&&(t=Le[l.charCodeAt(k)]<<2|Le[l.charCodeAt(k+1)]>>4,o[d++]=t&255),u===1&&(t=Le[l.charCodeAt(k)]<<10|Le[l.charCodeAt(k+1)]<<4|Le[l.charCodeAt(k+2)]>>2,o[d++]=t>>8&255,o[d++]=t&255),o}function Gi(l){return Ye[l>>18&63]+Ye[l>>12&63]+Ye[l>>6&63]+Ye[l&63]}function Vi(l,t,e){for(var a,u=[],o=t;o<e;o+=3)a=(l[o]<<16&16711680)+(l[o+1]<<8&65280)+(l[o+2]&255),u.push(Gi(a));return u.join("")}function $i(l){for(var t,e=l.length,a=e%3,u=[],o=16383,d=0,h=e-a;d<h;d+=o)u.push(Vi(l,d,d+o>h?h:d+o));return a===1?(t=l[e-1],u.push(Ye[t>>2]+Ye[t<<4&63]+"==")):a===2&&(t=(l[e-2]<<8)+l[e-1],u.push(Ye[t>>10]+Ye[t>>4&63]+Ye[t<<2&63]+"=")),u.join("")}var zt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */zt.read=function(l,t,e,a,u){var o,d,h=u*8-a-1,k=(1<<h)-1,g=k>>1,f=-7,v=e?u-1:0,I=e?-1:1,m=l[t+v];for(v+=I,o=m&(1<<-f)-1,m>>=-f,f+=h;f>0;o=o*256+l[t+v],v+=I,f-=8);for(d=o&(1<<-f)-1,o>>=-f,f+=a;f>0;d=d*256+l[t+v],v+=I,f-=8);if(o===0)o=1-g;else{if(o===k)return d?NaN:(m?-1:1)*(1/0);d=d+Math.pow(2,a),o=o-g}return(m?-1:1)*d*Math.pow(2,o-a)},zt.write=function(l,t,e,a,u,o){var d,h,k,g=o*8-u-1,f=(1<<g)-1,v=f>>1,I=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=a?0:o-1,D=a?1:-1,R=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(h=isNaN(t)?1:0,d=f):(d=Math.floor(Math.log(t)/Math.LN2),t*(k=Math.pow(2,-d))<1&&(d--,k*=2),d+v>=1?t+=I/k:t+=I*Math.pow(2,1-v),t*k>=2&&(d++,k/=2),d+v>=f?(h=0,d=f):d+v>=1?(h=(t*k-1)*Math.pow(2,u),d=d+v):(h=t*Math.pow(2,v-1)*Math.pow(2,u),d=0));u>=8;l[e+m]=h&255,m+=D,h/=256,u-=8);for(d=d<<u|h,g+=u;g>0;l[e+m]=d&255,m+=D,d/=256,g-=8);l[e+m-D]|=R*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(l){const t=It,e=zt,a=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;l.Buffer=f,l.SlowBuffer=S,l.INSPECT_MAX_BYTES=50;const u=2147483647;l.kMaxLength=u;const{Uint8Array:o,ArrayBuffer:d,SharedArrayBuffer:h}=globalThis;f.TYPED_ARRAY_SUPPORT=k(),!f.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function k(){try{const s=new o(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,o.prototype),Object.setPrototypeOf(s,n),s.foo()===42}catch{return!1}}Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.buffer}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){if(f.isBuffer(this))return this.byteOffset}});function g(s){if(s>u)throw new RangeError('The value "'+s+'" is invalid for option "size"');const n=new o(s);return Object.setPrototypeOf(n,f.prototype),n}function f(s,n,r){if(typeof s=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return D(s)}return v(s,n,r)}f.poolSize=8192;function v(s,n,r){if(typeof s=="string")return R(s,n);if(d.isView(s))return U(s);if(s==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s);if(ne(s,d)||s&&ne(s.buffer,d)||typeof h<"u"&&(ne(s,h)||s&&ne(s.buffer,h)))return Z(s,n,r);if(typeof s=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _=s.valueOf&&s.valueOf();if(_!=null&&_!==s)return f.from(_,n,r);const x=N(s);if(x)return x;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof s[Symbol.toPrimitive]=="function")return f.from(s[Symbol.toPrimitive]("string"),n,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof s)}f.from=function(s,n,r){return v(s,n,r)},Object.setPrototypeOf(f.prototype,o.prototype),Object.setPrototypeOf(f,o);function I(s){if(typeof s!="number")throw new TypeError('"size" argument must be of type number');if(s<0)throw new RangeError('The value "'+s+'" is invalid for option "size"')}function m(s,n,r){return I(s),s<=0?g(s):n!==void 0?typeof r=="string"?g(s).fill(n,r):g(s).fill(n):g(s)}f.alloc=function(s,n,r){return m(s,n,r)};function D(s){return I(s),g(s<0?0:E(s)|0)}f.allocUnsafe=function(s){return D(s)},f.allocUnsafeSlow=function(s){return D(s)};function R(s,n){if((typeof n!="string"||n==="")&&(n="utf8"),!f.isEncoding(n))throw new TypeError("Unknown encoding: "+n);const r=O(s,n)|0;let _=g(r);const x=_.write(s,n);return x!==r&&(_=_.slice(0,x)),_}function T(s){const n=s.length<0?0:E(s.length)|0,r=g(n);for(let _=0;_<n;_+=1)r[_]=s[_]&255;return r}function U(s){if(ne(s,o)){const n=new o(s);return Z(n.buffer,n.byteOffset,n.byteLength)}return T(s)}function Z(s,n,r){if(n<0||s.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(s.byteLength<n+(r||0))throw new RangeError('"length" is outside of buffer bounds');let _;return n===void 0&&r===void 0?_=new o(s):r===void 0?_=new o(s,n):_=new o(s,n,r),Object.setPrototypeOf(_,f.prototype),_}function N(s){if(f.isBuffer(s)){const n=E(s.length)|0,r=g(n);return r.length===0||s.copy(r,0,0,n),r}if(s.length!==void 0)return typeof s.length!="number"||De(s.length)?g(0):T(s);if(s.type==="Buffer"&&Array.isArray(s.data))return T(s.data)}function E(s){if(s>=u)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+u.toString(16)+" bytes");return s|0}function S(s){return+s!=s&&(s=0),f.alloc(+s)}f.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==f.prototype},f.compare=function(n,r){if(ne(n,o)&&(n=f.from(n,n.offset,n.byteLength)),ne(r,o)&&(r=f.from(r,r.offset,r.byteLength)),!f.isBuffer(n)||!f.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===r)return 0;let _=n.length,x=r.length;for(let p=0,y=Math.min(_,x);p<y;++p)if(n[p]!==r[p]){_=n[p],x=r[p];break}return _<x?-1:x<_?1:0},f.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(n,r){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return f.alloc(0);let _;if(r===void 0)for(r=0,_=0;_<n.length;++_)r+=n[_].length;const x=f.allocUnsafe(r);let p=0;for(_=0;_<n.length;++_){let y=n[_];if(ne(y,o))p+y.length>x.length?(f.isBuffer(y)||(y=f.from(y)),y.copy(x,p)):o.prototype.set.call(x,y,p);else if(f.isBuffer(y))y.copy(x,p);else throw new TypeError('"list" argument must be an Array of Buffers');p+=y.length}return x};function O(s,n){if(f.isBuffer(s))return s.length;if(d.isView(s)||ne(s,d))return s.byteLength;if(typeof s!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof s);const r=s.length,_=arguments.length>2&&arguments[2]===!0;if(!_&&r===0)return 0;let x=!1;for(;;)switch(n){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Re(s).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return ge(s).length;default:if(x)return _?-1:Re(s).length;n=(""+n).toLowerCase(),x=!0}}f.byteLength=O;function C(s,n,r){let _=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,n>>>=0,r<=n))return"";for(s||(s="utf8");;)switch(s){case"hex":return le(this,n,r);case"utf8":case"utf-8":return ve(this,n,r);case"ascii":return te(this,n,r);case"latin1":case"binary":return fe(this,n,r);case"base64":return ke(this,n,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,n,r);default:if(_)throw new TypeError("Unknown encoding: "+s);s=(s+"").toLowerCase(),_=!0}}f.prototype._isBuffer=!0;function $(s,n,r){const _=s[n];s[n]=s[r],s[r]=_}f.prototype.swap16=function(){const n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<n;r+=2)$(this,r,r+1);return this},f.prototype.swap32=function(){const n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<n;r+=4)$(this,r,r+3),$(this,r+1,r+2);return this},f.prototype.swap64=function(){const n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<n;r+=8)$(this,r,r+7),$(this,r+1,r+6),$(this,r+2,r+5),$(this,r+3,r+4);return this},f.prototype.toString=function(){const n=this.length;return n===0?"":arguments.length===0?ve(this,0,n):C.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(n){if(!f.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:f.compare(this,n)===0},f.prototype.inspect=function(){let n="";const r=l.INSPECT_MAX_BYTES;return n=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(n+=" ... "),"<Buffer "+n+">"},a&&(f.prototype[a]=f.prototype.inspect),f.prototype.compare=function(n,r,_,x,p){if(ne(n,o)&&(n=f.from(n,n.offset,n.byteLength)),!f.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(r===void 0&&(r=0),_===void 0&&(_=n?n.length:0),x===void 0&&(x=0),p===void 0&&(p=this.length),r<0||_>n.length||x<0||p>this.length)throw new RangeError("out of range index");if(x>=p&&r>=_)return 0;if(x>=p)return-1;if(r>=_)return 1;if(r>>>=0,_>>>=0,x>>>=0,p>>>=0,this===n)return 0;let y=p-x,c=_-r;const L=Math.min(y,c),K=this.slice(x,p),P=n.slice(r,_);for(let Q=0;Q<L;++Q)if(K[Q]!==P[Q]){y=K[Q],c=P[Q];break}return y<c?-1:c<y?1:0};function X(s,n,r,_,x){if(s.length===0)return-1;if(typeof r=="string"?(_=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,De(r)&&(r=x?0:s.length-1),r<0&&(r=s.length+r),r>=s.length){if(x)return-1;r=s.length-1}else if(r<0)if(x)r=0;else return-1;if(typeof n=="string"&&(n=f.from(n,_)),f.isBuffer(n))return n.length===0?-1:V(s,n,r,_,x);if(typeof n=="number")return n=n&255,typeof o.prototype.indexOf=="function"?x?o.prototype.indexOf.call(s,n,r):o.prototype.lastIndexOf.call(s,n,r):V(s,[n],r,_,x);throw new TypeError("val must be string, number or Buffer")}function V(s,n,r,_,x){let p=1,y=s.length,c=n.length;if(_!==void 0&&(_=String(_).toLowerCase(),_==="ucs2"||_==="ucs-2"||_==="utf16le"||_==="utf-16le")){if(s.length<2||n.length<2)return-1;p=2,y/=2,c/=2,r/=2}function L(P,Q){return p===1?P[Q]:P.readUInt16BE(Q*p)}let K;if(x){let P=-1;for(K=r;K<y;K++)if(L(s,K)===L(n,P===-1?0:K-P)){if(P===-1&&(P=K),K-P+1===c)return P*p}else P!==-1&&(K-=K-P),P=-1}else for(r+c>y&&(r=y-c),K=r;K>=0;K--){let P=!0;for(let Q=0;Q<c;Q++)if(L(s,K+Q)!==L(n,Q)){P=!1;break}if(P)return K}return-1}f.prototype.includes=function(n,r,_){return this.indexOf(n,r,_)!==-1},f.prototype.indexOf=function(n,r,_){return X(this,n,r,_,!0)},f.prototype.lastIndexOf=function(n,r,_){return X(this,n,r,_,!1)};function H(s,n,r,_){r=Number(r)||0;const x=s.length-r;_?(_=Number(_),_>x&&(_=x)):_=x;const p=n.length;_>p/2&&(_=p/2);let y;for(y=0;y<_;++y){const c=parseInt(n.substr(y*2,2),16);if(De(c))return y;s[r+y]=c}return y}function q(s,n,r,_){return we(Re(n,s.length-r),s,r,_)}function J(s,n,r,_){return we(lt(n),s,r,_)}function se(s,n,r,_){return we(ge(n),s,r,_)}function ue(s,n,r,_){return we(Se(n,s.length-r),s,r,_)}f.prototype.write=function(n,r,_,x){if(r===void 0)x="utf8",_=this.length,r=0;else if(_===void 0&&typeof r=="string")x=r,_=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(_)?(_=_>>>0,x===void 0&&(x="utf8")):(x=_,_=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const p=this.length-r;if((_===void 0||_>p)&&(_=p),n.length>0&&(_<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");let y=!1;for(;;)switch(x){case"hex":return H(this,n,r,_);case"utf8":case"utf-8":return q(this,n,r,_);case"ascii":case"latin1":case"binary":return J(this,n,r,_);case"base64":return se(this,n,r,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,n,r,_);default:if(y)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),y=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ke(s,n,r){return n===0&&r===s.length?t.fromByteArray(s):t.fromByteArray(s.slice(n,r))}function ve(s,n,r){r=Math.min(s.length,r);const _=[];let x=n;for(;x<r;){const p=s[x];let y=null,c=p>239?4:p>223?3:p>191?2:1;if(x+c<=r){let L,K,P,Q;switch(c){case 1:p<128&&(y=p);break;case 2:L=s[x+1],(L&192)===128&&(Q=(p&31)<<6|L&63,Q>127&&(y=Q));break;case 3:L=s[x+1],K=s[x+2],(L&192)===128&&(K&192)===128&&(Q=(p&15)<<12|(L&63)<<6|K&63,Q>2047&&(Q<55296||Q>57343)&&(y=Q));break;case 4:L=s[x+1],K=s[x+2],P=s[x+3],(L&192)===128&&(K&192)===128&&(P&192)===128&&(Q=(p&15)<<18|(L&63)<<12|(K&63)<<6|P&63,Q>65535&&Q<1114112&&(y=Q))}}y===null?(y=65533,c=1):y>65535&&(y-=65536,_.push(y>>>10&1023|55296),y=56320|y&1023),_.push(y),x+=c}return Ce(_)}const ye=4096;function Ce(s){const n=s.length;if(n<=ye)return String.fromCharCode.apply(String,s);let r="",_=0;for(;_<n;)r+=String.fromCharCode.apply(String,s.slice(_,_+=ye));return r}function te(s,n,r){let _="";r=Math.min(s.length,r);for(let x=n;x<r;++x)_+=String.fromCharCode(s[x]&127);return _}function fe(s,n,r){let _="";r=Math.min(s.length,r);for(let x=n;x<r;++x)_+=String.fromCharCode(s[x]);return _}function le(s,n,r){const _=s.length;(!n||n<0)&&(n=0),(!r||r<0||r>_)&&(r=_);let x="";for(let p=n;p<r;++p)x+=qe[s[p]];return x}function Ne(s,n,r){const _=s.slice(n,r);let x="";for(let p=0;p<_.length-1;p+=2)x+=String.fromCharCode(_[p]+_[p+1]*256);return x}f.prototype.slice=function(n,r){const _=this.length;n=~~n,r=r===void 0?_:~~r,n<0?(n+=_,n<0&&(n=0)):n>_&&(n=_),r<0?(r+=_,r<0&&(r=0)):r>_&&(r=_),r<n&&(r=n);const x=this.subarray(n,r);return Object.setPrototypeOf(x,f.prototype),x};function oe(s,n,r){if(s%1!==0||s<0)throw new RangeError("offset is not uint");if(s+n>r)throw new RangeError("Trying to access beyond buffer length")}f.prototype.readUintLE=f.prototype.readUIntLE=function(n,r,_){n=n>>>0,r=r>>>0,_||oe(n,r,this.length);let x=this[n],p=1,y=0;for(;++y<r&&(p*=256);)x+=this[n+y]*p;return x},f.prototype.readUintBE=f.prototype.readUIntBE=function(n,r,_){n=n>>>0,r=r>>>0,_||oe(n,r,this.length);let x=this[n+--r],p=1;for(;r>0&&(p*=256);)x+=this[n+--r]*p;return x},f.prototype.readUint8=f.prototype.readUInt8=function(n,r){return n=n>>>0,r||oe(n,1,this.length),this[n]},f.prototype.readUint16LE=f.prototype.readUInt16LE=function(n,r){return n=n>>>0,r||oe(n,2,this.length),this[n]|this[n+1]<<8},f.prototype.readUint16BE=f.prototype.readUInt16BE=function(n,r){return n=n>>>0,r||oe(n,2,this.length),this[n]<<8|this[n+1]},f.prototype.readUint32LE=f.prototype.readUInt32LE=function(n,r){return n=n>>>0,r||oe(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},f.prototype.readUint32BE=f.prototype.readUInt32BE=function(n,r){return n=n>>>0,r||oe(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},f.prototype.readBigUInt64LE=Ee(function(n){n=n>>>0,$e(n,"offset");const r=this[n],_=this[n+7];(r===void 0||_===void 0)&&xe(n,this.length-8);const x=r+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24,p=this[++n]+this[++n]*2**8+this[++n]*2**16+_*2**24;return BigInt(x)+(BigInt(p)<<BigInt(32))}),f.prototype.readBigUInt64BE=Ee(function(n){n=n>>>0,$e(n,"offset");const r=this[n],_=this[n+7];(r===void 0||_===void 0)&&xe(n,this.length-8);const x=r*2**24+this[++n]*2**16+this[++n]*2**8+this[++n],p=this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+_;return(BigInt(x)<<BigInt(32))+BigInt(p)}),f.prototype.readIntLE=function(n,r,_){n=n>>>0,r=r>>>0,_||oe(n,r,this.length);let x=this[n],p=1,y=0;for(;++y<r&&(p*=256);)x+=this[n+y]*p;return p*=128,x>=p&&(x-=Math.pow(2,8*r)),x},f.prototype.readIntBE=function(n,r,_){n=n>>>0,r=r>>>0,_||oe(n,r,this.length);let x=r,p=1,y=this[n+--x];for(;x>0&&(p*=256);)y+=this[n+--x]*p;return p*=128,y>=p&&(y-=Math.pow(2,8*r)),y},f.prototype.readInt8=function(n,r){return n=n>>>0,r||oe(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},f.prototype.readInt16LE=function(n,r){n=n>>>0,r||oe(n,2,this.length);const _=this[n]|this[n+1]<<8;return _&32768?_|4294901760:_},f.prototype.readInt16BE=function(n,r){n=n>>>0,r||oe(n,2,this.length);const _=this[n+1]|this[n]<<8;return _&32768?_|4294901760:_},f.prototype.readInt32LE=function(n,r){return n=n>>>0,r||oe(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},f.prototype.readInt32BE=function(n,r){return n=n>>>0,r||oe(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},f.prototype.readBigInt64LE=Ee(function(n){n=n>>>0,$e(n,"offset");const r=this[n],_=this[n+7];(r===void 0||_===void 0)&&xe(n,this.length-8);const x=this[n+4]+this[n+5]*2**8+this[n+6]*2**16+(_<<24);return(BigInt(x)<<BigInt(32))+BigInt(r+this[++n]*2**8+this[++n]*2**16+this[++n]*2**24)}),f.prototype.readBigInt64BE=Ee(function(n){n=n>>>0,$e(n,"offset");const r=this[n],_=this[n+7];(r===void 0||_===void 0)&&xe(n,this.length-8);const x=(r<<24)+this[++n]*2**16+this[++n]*2**8+this[++n];return(BigInt(x)<<BigInt(32))+BigInt(this[++n]*2**24+this[++n]*2**16+this[++n]*2**8+_)}),f.prototype.readFloatLE=function(n,r){return n=n>>>0,r||oe(n,4,this.length),e.read(this,n,!0,23,4)},f.prototype.readFloatBE=function(n,r){return n=n>>>0,r||oe(n,4,this.length),e.read(this,n,!1,23,4)},f.prototype.readDoubleLE=function(n,r){return n=n>>>0,r||oe(n,8,this.length),e.read(this,n,!0,52,8)},f.prototype.readDoubleBE=function(n,r){return n=n>>>0,r||oe(n,8,this.length),e.read(this,n,!1,52,8)};function ie(s,n,r,_,x,p){if(!f.isBuffer(s))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>x||n<p)throw new RangeError('"value" argument is out of bounds');if(r+_>s.length)throw new RangeError("Index out of range")}f.prototype.writeUintLE=f.prototype.writeUIntLE=function(n,r,_,x){if(n=+n,r=r>>>0,_=_>>>0,!x){const c=Math.pow(2,8*_)-1;ie(this,n,r,_,c,0)}let p=1,y=0;for(this[r]=n&255;++y<_&&(p*=256);)this[r+y]=n/p&255;return r+_},f.prototype.writeUintBE=f.prototype.writeUIntBE=function(n,r,_,x){if(n=+n,r=r>>>0,_=_>>>0,!x){const c=Math.pow(2,8*_)-1;ie(this,n,r,_,c,0)}let p=_-1,y=1;for(this[r+p]=n&255;--p>=0&&(y*=256);)this[r+p]=n/y&255;return r+_},f.prototype.writeUint8=f.prototype.writeUInt8=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,1,255,0),this[r]=n&255,r+1},f.prototype.writeUint16LE=f.prototype.writeUInt16LE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,2,65535,0),this[r]=n&255,this[r+1]=n>>>8,r+2},f.prototype.writeUint16BE=f.prototype.writeUInt16BE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,2,65535,0),this[r]=n>>>8,this[r+1]=n&255,r+2},f.prototype.writeUint32LE=f.prototype.writeUInt32LE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,4,4294967295,0),this[r+3]=n>>>24,this[r+2]=n>>>16,this[r+1]=n>>>8,this[r]=n&255,r+4},f.prototype.writeUint32BE=f.prototype.writeUInt32BE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,4,4294967295,0),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=n&255,r+4};function he(s,n,r,_,x){Be(n,_,x,s,r,7);let p=Number(n&BigInt(4294967295));s[r++]=p,p=p>>8,s[r++]=p,p=p>>8,s[r++]=p,p=p>>8,s[r++]=p;let y=Number(n>>BigInt(32)&BigInt(4294967295));return s[r++]=y,y=y>>8,s[r++]=y,y=y>>8,s[r++]=y,y=y>>8,s[r++]=y,r}function Ge(s,n,r,_,x){Be(n,_,x,s,r,7);let p=Number(n&BigInt(4294967295));s[r+7]=p,p=p>>8,s[r+6]=p,p=p>>8,s[r+5]=p,p=p>>8,s[r+4]=p;let y=Number(n>>BigInt(32)&BigInt(4294967295));return s[r+3]=y,y=y>>8,s[r+2]=y,y=y>>8,s[r+1]=y,y=y>>8,s[r]=y,r+8}f.prototype.writeBigUInt64LE=Ee(function(n,r=0){return he(this,n,r,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeBigUInt64BE=Ee(function(n,r=0){return Ge(this,n,r,BigInt(0),BigInt("0xffffffffffffffff"))}),f.prototype.writeIntLE=function(n,r,_,x){if(n=+n,r=r>>>0,!x){const L=Math.pow(2,8*_-1);ie(this,n,r,_,L-1,-L)}let p=0,y=1,c=0;for(this[r]=n&255;++p<_&&(y*=256);)n<0&&c===0&&this[r+p-1]!==0&&(c=1),this[r+p]=(n/y>>0)-c&255;return r+_},f.prototype.writeIntBE=function(n,r,_,x){if(n=+n,r=r>>>0,!x){const L=Math.pow(2,8*_-1);ie(this,n,r,_,L-1,-L)}let p=_-1,y=1,c=0;for(this[r+p]=n&255;--p>=0&&(y*=256);)n<0&&c===0&&this[r+p+1]!==0&&(c=1),this[r+p]=(n/y>>0)-c&255;return r+_},f.prototype.writeInt8=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,1,127,-128),n<0&&(n=255+n+1),this[r]=n&255,r+1},f.prototype.writeInt16LE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,2,32767,-32768),this[r]=n&255,this[r+1]=n>>>8,r+2},f.prototype.writeInt16BE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,2,32767,-32768),this[r]=n>>>8,this[r+1]=n&255,r+2},f.prototype.writeInt32LE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,4,2147483647,-2147483648),this[r]=n&255,this[r+1]=n>>>8,this[r+2]=n>>>16,this[r+3]=n>>>24,r+4},f.prototype.writeInt32BE=function(n,r,_){return n=+n,r=r>>>0,_||ie(this,n,r,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[r]=n>>>24,this[r+1]=n>>>16,this[r+2]=n>>>8,this[r+3]=n&255,r+4},f.prototype.writeBigInt64LE=Ee(function(n,r=0){return he(this,n,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),f.prototype.writeBigInt64BE=Ee(function(n,r=0){return Ge(this,n,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ve(s,n,r,_,x,p){if(r+_>s.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function je(s,n,r,_,x){return n=+n,r=r>>>0,x||Ve(s,n,r,4),e.write(s,n,r,_,23,4),r+4}f.prototype.writeFloatLE=function(n,r,_){return je(this,n,r,!0,_)},f.prototype.writeFloatBE=function(n,r,_){return je(this,n,r,!1,_)};function Ie(s,n,r,_,x){return n=+n,r=r>>>0,x||Ve(s,n,r,8),e.write(s,n,r,_,52,8),r+8}f.prototype.writeDoubleLE=function(n,r,_){return Ie(this,n,r,!0,_)},f.prototype.writeDoubleBE=function(n,r,_){return Ie(this,n,r,!1,_)},f.prototype.copy=function(n,r,_,x){if(!f.isBuffer(n))throw new TypeError("argument should be a Buffer");if(_||(_=0),!x&&x!==0&&(x=this.length),r>=n.length&&(r=n.length),r||(r=0),x>0&&x<_&&(x=_),x===_||n.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(_<0||_>=this.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),n.length-r<x-_&&(x=n.length-r+_);const p=x-_;return this===n&&typeof o.prototype.copyWithin=="function"?this.copyWithin(r,_,x):o.prototype.set.call(n,this.subarray(_,x),r),p},f.prototype.fill=function(n,r,_,x){if(typeof n=="string"){if(typeof r=="string"?(x=r,r=0,_=this.length):typeof _=="string"&&(x=_,_=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!f.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(n.length===1){const y=n.charCodeAt(0);(x==="utf8"&&y<128||x==="latin1")&&(n=y)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(r<0||this.length<r||this.length<_)throw new RangeError("Out of range index");if(_<=r)return this;r=r>>>0,_=_===void 0?this.length:_>>>0,n||(n=0);let p;if(typeof n=="number")for(p=r;p<_;++p)this[p]=n;else{const y=f.isBuffer(n)?n:f.from(n,x),c=y.length;if(c===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(p=0;p<_-r;++p)this[p+r]=y[p%c]}return this};const re={};function de(s,n,r){re[s]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:n.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${s}]`,this.stack,delete this.name}get code(){return s}set code(x){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:x,writable:!0})}toString(){return`${this.name} [${s}]: ${this.message}`}}}de("ERR_BUFFER_OUT_OF_BOUNDS",function(s){return s?`${s} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),de("ERR_INVALID_ARG_TYPE",function(s,n){return`The "${s}" argument must be of type number. Received type ${typeof n}`},TypeError),de("ERR_OUT_OF_RANGE",function(s,n,r){let _=`The value of "${s}" is out of range.`,x=r;return Number.isInteger(r)&&Math.abs(r)>2**32?x=Ae(String(r)):typeof r=="bigint"&&(x=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(x=Ae(x)),x+="n"),_+=` It must be ${n}. Received ${x}`,_},RangeError);function Ae(s){let n="",r=s.length;const _=s[0]==="-"?1:0;for(;r>=_+4;r-=3)n=`_${s.slice(r-3,r)}${n}`;return`${s.slice(0,r)}${n}`}function Ue(s,n,r){$e(n,"offset"),(s[n]===void 0||s[n+r]===void 0)&&xe(n,s.length-(r+1))}function Be(s,n,r,_,x,p){if(s>r||s<n){const y=typeof n=="bigint"?"n":"";let c;throw n===0||n===BigInt(0)?c=`>= 0${y} and < 2${y} ** ${(p+1)*8}${y}`:c=`>= -(2${y} ** ${(p+1)*8-1}${y}) and < 2 ** ${(p+1)*8-1}${y}`,new re.ERR_OUT_OF_RANGE("value",c,s)}Ue(_,x,p)}function $e(s,n){if(typeof s!="number")throw new re.ERR_INVALID_ARG_TYPE(n,"number",s)}function xe(s,n,r){throw Math.floor(s)!==s?($e(s,r),new re.ERR_OUT_OF_RANGE("offset","an integer",s)):n<0?new re.ERR_BUFFER_OUT_OF_BOUNDS:new re.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${n}`,s)}const Qe=/[^+/0-9A-Za-z-_]/g;function Te(s){if(s=s.split("=")[0],s=s.trim().replace(Qe,""),s.length<2)return"";for(;s.length%4!==0;)s=s+"=";return s}function Re(s,n){n=n||1/0;let r;const _=s.length;let x=null;const p=[];for(let y=0;y<_;++y){if(r=s.charCodeAt(y),r>55295&&r<57344){if(!x){if(r>56319){(n-=3)>-1&&p.push(239,191,189);continue}else if(y+1===_){(n-=3)>-1&&p.push(239,191,189);continue}x=r;continue}if(r<56320){(n-=3)>-1&&p.push(239,191,189),x=r;continue}r=(x-55296<<10|r-56320)+65536}else x&&(n-=3)>-1&&p.push(239,191,189);if(x=null,r<128){if((n-=1)<0)break;p.push(r)}else if(r<2048){if((n-=2)<0)break;p.push(r>>6|192,r&63|128)}else if(r<65536){if((n-=3)<0)break;p.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((n-=4)<0)break;p.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return p}function lt(s){const n=[];for(let r=0;r<s.length;++r)n.push(s.charCodeAt(r)&255);return n}function Se(s,n){let r,_,x;const p=[];for(let y=0;y<s.length&&!((n-=2)<0);++y)r=s.charCodeAt(y),_=r>>8,x=r%256,p.push(x),p.push(_);return p}function ge(s){return t.toByteArray(Te(s))}function we(s,n,r,_){let x;for(x=0;x<_&&!(x+r>=n.length||x>=s.length);++x)n[x+r]=s[x];return x}function ne(s,n){return s instanceof n||s!=null&&s.constructor!=null&&s.constructor.name!=null&&s.constructor.name===n.name}function De(s){return s!==s}const qe=(function(){const s="0123456789abcdef",n=new Array(256);for(let r=0;r<16;++r){const _=r*16;for(let x=0;x<16;++x)n[_+x]=s[r]+s[x]}return n})();function Ee(s){return typeof BigInt>"u"?w:s}function w(){throw new Error("BigInt not supported")}})(ln);const _t=ln.Buffer;function un(l){const t=l.lastIndexOf(".");return t===-1||t===l.length-1?"":l.substring(t)}function Xi(l){const t=l.replace(/\\/g,"/"),e=t.lastIndexOf("/");return e===-1?t:t.substring(e+1)}function At(...l){if(l.length===0)return"";const t=l.filter(a=>a&&a.length>0);if(t.length===0)return"";let e=t.join("/");return e=e.replace(/\/+/g,"/"),e.length>1&&e.endsWith("/")&&(e=e.slice(0,-1)),e}function Bt(l){if(!l)return"";let t=l.replace(/\\/g,"/");const e=t.split("/"),a=[];for(const o of e)if(!(o===""&&a.length>0)){if(o===".")continue;o===".."?a.length>0&&a[a.length-1]!==".."?a.pop():t.startsWith("/")||a.push(".."):a.push(o)}let u=a.join("/");return t.startsWith("/")&&!u.startsWith("/")&&(u="/"+u),u||"."}function Hi(l,t){return t?t.startsWith("/")||t.includes("://")?Bt(t):Bt(At(l,t)):Bt(l)}var wt={},hn;function Wi(){if(hn)return wt;hn=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.BinaryReader=void 0;class l{constructor(e){this.offset=0,this.binary=e}readUint8(){return this.binary[this.offset++].valueOf()}readUint8AsString(){return String.fromCharCode(this.binary[this.offset++].valueOf())}readUint8AsBool(){return this.binary[this.offset++].valueOf()!==0}readUint16(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,2).getUint16(0,!0);return this.offset+=2,e}readUint32(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,4).getUint32(0,!0);return this.offset+=4,e}readUint64(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,8).getBigUint64(0,!0);return this.offset+=8,e}readInt8(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,1).getInt8(0);return this.offset+=1,e}readInt16(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,2).getInt16(0,!0);return this.offset+=2,e}readInt32(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,4).getInt32(0,!0);return this.offset+=4,e}readInt64(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,8).getBigInt64(0,!0);return this.offset+=8,e}readFloat32(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,4).getFloat32(0,!0);return this.offset+=4,e}readFloat64(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,8).getFloat64(0,!0);return this.offset+=8,e}readUint8Array(e){return this.binary.subarray(this.offset,this.offset+=e)}readArrayAsString(e){return String.fromCharCode.apply(null,this.binary.subarray(this.offset,this.offset+=e))}}return wt.BinaryReader=l,wt}var ut=Wi();ut.BinaryReader.prototype.readUint64=function(){const l=this.readUint32();return this.readUint32()*4294967296+l},ut.BinaryReader.prototype.readInt64=function(){let l=this.readUint32(),t=this.readUint32();return t&2147483648?(t=~t&4294967295,l=~l&4294967295,l===4294967295&&(t=t+1&4294967295),l=l+1&4294967295,-(t*4294967296+l)):t*4294967296+l},ut.BinaryReader.prototype.readUint8Array=function(l){return _t.from(this.binary.buffer.slice(this.offset,this.offset+=l))};function ht(l){let t=l.length;for(;--t>=0;)l[t]=0}const ji=3,qi=258,dn=29,Yi=256+1+dn,pn=30,Ki=512,Qi=new Array((Yi+2)*2);ht(Qi);const Ji=new Array(pn*2);ht(Ji);const er=new Array(Ki);ht(er);const tr=new Array(qi-ji+1);ht(tr);const nr=new Array(dn);ht(nr);const ir=new Array(pn);ht(ir);var Lt=(l,t,e,a)=>{let u=l&65535|0,o=l>>>16&65535|0,d=0;for(;e!==0;){d=e>2e3?2e3:e,e-=d;do u=u+t[a++]|0,o=o+u|0;while(--d);u%=65521,o%=65521}return u|o<<16|0};const rr=()=>{let l,t=[];for(var e=0;e<256;e++){l=e;for(var a=0;a<8;a++)l=l&1?3988292384^l>>>1:l>>>1;t[e]=l}return t},or=new Uint32Array(rr());var Ke=(l,t,e,a)=>{const u=or,o=a+e;l^=-1;for(let d=a;d<o;d++)l=l>>>8^u[(l^t[d])&255];return l^-1},Pt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},_n={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const ar=(l,t)=>Object.prototype.hasOwnProperty.call(l,t);var sr=function(l){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const a in e)ar(e,a)&&(l[a]=e[a])}}return l},fr=l=>{let t=0;for(let a=0,u=l.length;a<u;a++)t+=l[a].length;const e=new Uint8Array(t);for(let a=0,u=0,o=l.length;a<o;a++){let d=l[a];e.set(d,u),u+=d.length}return e},wn={assign:sr,flattenChunks:fr};let gn=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{gn=!1}const gt=new Uint8Array(256);for(let l=0;l<256;l++)gt[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;gt[254]=gt[254]=1;var lr=l=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(l);let t,e,a,u,o,d=l.length,h=0;for(u=0;u<d;u++)e=l.charCodeAt(u),(e&64512)===55296&&u+1<d&&(a=l.charCodeAt(u+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),u++)),h+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(h),o=0,u=0;o<h;u++)e=l.charCodeAt(u),(e&64512)===55296&&u+1<d&&(a=l.charCodeAt(u+1),(a&64512)===56320&&(e=65536+(e-55296<<10)+(a-56320),u++)),e<128?t[o++]=e:e<2048?(t[o++]=192|e>>>6,t[o++]=128|e&63):e<65536?(t[o++]=224|e>>>12,t[o++]=128|e>>>6&63,t[o++]=128|e&63):(t[o++]=240|e>>>18,t[o++]=128|e>>>12&63,t[o++]=128|e>>>6&63,t[o++]=128|e&63);return t};const cr=(l,t)=>{if(t<65534&&l.subarray&&gn)return String.fromCharCode.apply(null,l.length===t?l:l.subarray(0,t));let e="";for(let a=0;a<t;a++)e+=String.fromCharCode(l[a]);return e};var ur=(l,t)=>{const e=t||l.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(l.subarray(0,t));let a,u;const o=new Array(e*2);for(u=0,a=0;a<e;){let d=l[a++];if(d<128){o[u++]=d;continue}let h=gt[d];if(h>4){o[u++]=65533,a+=h-1;continue}for(d&=h===2?31:h===3?15:7;h>1&&a<e;)d=d<<6|l[a++]&63,h--;if(h>1){o[u++]=65533;continue}d<65536?o[u++]=d:(d-=65536,o[u++]=55296|d>>10&1023,o[u++]=56320|d&1023)}return cr(o,u)},hr=(l,t)=>{t=t||l.length,t>l.length&&(t=l.length);let e=t-1;for(;e>=0&&(l[e]&192)===128;)e--;return e<0||e===0?t:e+gt[l[e]]>t?e:t},Zt={string2buf:lr,buf2string:ur,utf8border:hr};function dr(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var pr=dr;const Tt=16209,_r=16191;var wr=function(t,e){let a,u,o,d,h,k,g,f,v,I,m,D,R,T,U,Z,N,E,S,O,C,$,X,V;const H=t.state;a=t.next_in,X=t.input,u=a+(t.avail_in-5),o=t.next_out,V=t.output,d=o-(e-t.avail_out),h=o+(t.avail_out-257),k=H.dmax,g=H.wsize,f=H.whave,v=H.wnext,I=H.window,m=H.hold,D=H.bits,R=H.lencode,T=H.distcode,U=(1<<H.lenbits)-1,Z=(1<<H.distbits)-1;e:do{D<15&&(m+=X[a++]<<D,D+=8,m+=X[a++]<<D,D+=8),N=R[m&U];t:for(;;){if(E=N>>>24,m>>>=E,D-=E,E=N>>>16&255,E===0)V[o++]=N&65535;else if(E&16){S=N&65535,E&=15,E&&(D<E&&(m+=X[a++]<<D,D+=8),S+=m&(1<<E)-1,m>>>=E,D-=E),D<15&&(m+=X[a++]<<D,D+=8,m+=X[a++]<<D,D+=8),N=T[m&Z];n:for(;;){if(E=N>>>24,m>>>=E,D-=E,E=N>>>16&255,E&16){if(O=N&65535,E&=15,D<E&&(m+=X[a++]<<D,D+=8,D<E&&(m+=X[a++]<<D,D+=8)),O+=m&(1<<E)-1,O>k){t.msg="invalid distance too far back",H.mode=Tt;break e}if(m>>>=E,D-=E,E=o-d,O>E){if(E=O-E,E>f&&H.sane){t.msg="invalid distance too far back",H.mode=Tt;break e}if(C=0,$=I,v===0){if(C+=g-E,E<S){S-=E;do V[o++]=I[C++];while(--E);C=o-O,$=V}}else if(v<E){if(C+=g+v-E,E-=v,E<S){S-=E;do V[o++]=I[C++];while(--E);if(C=0,v<S){E=v,S-=E;do V[o++]=I[C++];while(--E);C=o-O,$=V}}}else if(C+=v-E,E<S){S-=E;do V[o++]=I[C++];while(--E);C=o-O,$=V}for(;S>2;)V[o++]=$[C++],V[o++]=$[C++],V[o++]=$[C++],S-=3;S&&(V[o++]=$[C++],S>1&&(V[o++]=$[C++]))}else{C=o-O;do V[o++]=V[C++],V[o++]=V[C++],V[o++]=V[C++],S-=3;while(S>2);S&&(V[o++]=V[C++],S>1&&(V[o++]=V[C++]))}}else if((E&64)===0){N=T[(N&65535)+(m&(1<<E)-1)];continue n}else{t.msg="invalid distance code",H.mode=Tt;break e}break}}else if((E&64)===0){N=R[(N&65535)+(m&(1<<E)-1)];continue t}else if(E&32){H.mode=_r;break e}else{t.msg="invalid literal/length code",H.mode=Tt;break e}break}}while(a<u&&o<h);S=D>>3,a-=S,D-=S<<3,m&=(1<<D)-1,t.next_in=a,t.next_out=o,t.avail_in=a<u?5+(u-a):5-(a-u),t.avail_out=o<h?257+(h-o):257-(o-h),H.hold=m,H.bits=D};const dt=15,bn=852,mn=592,xn=0,Gt=1,yn=2,gr=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),br=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),mr=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),xr=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var bt=(l,t,e,a,u,o,d,h)=>{const k=h.bits;let g=0,f=0,v=0,I=0,m=0,D=0,R=0,T=0,U=0,Z=0,N,E,S,O,C,$=null,X;const V=new Uint16Array(dt+1),H=new Uint16Array(dt+1);let q=null,J,se,ue;for(g=0;g<=dt;g++)V[g]=0;for(f=0;f<a;f++)V[t[e+f]]++;for(m=k,I=dt;I>=1&&V[I]===0;I--);if(m>I&&(m=I),I===0)return u[o++]=1<<24|64<<16|0,u[o++]=1<<24|64<<16|0,h.bits=1,0;for(v=1;v<I&&V[v]===0;v++);for(m<v&&(m=v),T=1,g=1;g<=dt;g++)if(T<<=1,T-=V[g],T<0)return-1;if(T>0&&(l===xn||I!==1))return-1;for(H[1]=0,g=1;g<dt;g++)H[g+1]=H[g]+V[g];for(f=0;f<a;f++)t[e+f]!==0&&(d[H[t[e+f]]++]=f);if(l===xn?($=q=d,X=20):l===Gt?($=gr,q=br,X=257):($=mr,q=xr,X=0),Z=0,f=0,g=v,C=o,D=m,R=0,S=-1,U=1<<m,O=U-1,l===Gt&&U>bn||l===yn&&U>mn)return 1;for(;;){J=g-R,d[f]+1<X?(se=0,ue=d[f]):d[f]>=X?(se=q[d[f]-X],ue=$[d[f]-X]):(se=96,ue=0),N=1<<g-R,E=1<<D,v=E;do E-=N,u[C+(Z>>R)+E]=J<<24|se<<16|ue|0;while(E!==0);for(N=1<<g-1;Z&N;)N>>=1;if(N!==0?(Z&=N-1,Z+=N):Z=0,f++,--V[g]===0){if(g===I)break;g=t[e+d[f]]}if(g>m&&(Z&O)!==S){for(R===0&&(R=m),C+=v,D=g-R,T=1<<D;D+R<I&&(T-=V[D+R],!(T<=0));)D++,T<<=1;if(U+=1<<D,l===Gt&&U>bn||l===yn&&U>mn)return 1;S=Z&O,u[S]=m<<24|D<<16|C-o|0}}return Z!==0&&(u[C+Z]=g-R<<24|64<<16|0),h.bits=m,0};const yr=0,En=1,kn=2,{Z_FINISH:vn,Z_BLOCK:Er,Z_TREES:Rt,Z_OK:it,Z_STREAM_END:kr,Z_NEED_DICT:vr,Z_STREAM_ERROR:Pe,Z_DATA_ERROR:In,Z_MEM_ERROR:An,Z_BUF_ERROR:Ir,Z_DEFLATED:Bn}=_n,St=16180,Tn=16181,Rn=16182,Sn=16183,Fn=16184,Cn=16185,Nn=16186,Un=16187,Dn=16188,Mn=16189,Ft=16190,Je=16191,Vt=16192,On=16193,$t=16194,zn=16195,Ln=16196,Pn=16197,Zn=16198,Ct=16199,Nt=16200,Gn=16201,Vn=16202,$n=16203,Xn=16204,Hn=16205,Xt=16206,Wn=16207,jn=16208,_e=16209,qn=16210,Yn=16211,Ar=852,Br=592,Tr=15,Kn=l=>(l>>>24&255)+(l>>>8&65280)+((l&65280)<<8)+((l&255)<<24);function Rr(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const rt=l=>{if(!l)return 1;const t=l.state;return!t||t.strm!==l||t.mode<St||t.mode>Yn?1:0},Qn=l=>{if(rt(l))return Pe;const t=l.state;return l.total_in=l.total_out=t.total=0,l.msg="",t.wrap&&(l.adler=t.wrap&1),t.mode=St,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Ar),t.distcode=t.distdyn=new Int32Array(Br),t.sane=1,t.back=-1,it},Jn=l=>{if(rt(l))return Pe;const t=l.state;return t.wsize=0,t.whave=0,t.wnext=0,Qn(l)},ei=(l,t)=>{let e;if(rt(l))return Pe;const a=l.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Pe:(a.window!==null&&a.wbits!==t&&(a.window=null),a.wrap=e,a.wbits=t,Jn(l))},ti=(l,t)=>{if(!l)return Pe;const e=new Rr;l.state=e,e.strm=l,e.window=null,e.mode=St;const a=ei(l,t);return a!==it&&(l.state=null),a},Sr=l=>ti(l,Tr);let ni=!0,Ht,Wt;const Fr=l=>{if(ni){Ht=new Int32Array(512),Wt=new Int32Array(32);let t=0;for(;t<144;)l.lens[t++]=8;for(;t<256;)l.lens[t++]=9;for(;t<280;)l.lens[t++]=7;for(;t<288;)l.lens[t++]=8;for(bt(En,l.lens,0,288,Ht,0,l.work,{bits:9}),t=0;t<32;)l.lens[t++]=5;bt(kn,l.lens,0,32,Wt,0,l.work,{bits:5}),ni=!1}l.lencode=Ht,l.lenbits=9,l.distcode=Wt,l.distbits=5},ii=(l,t,e,a)=>{let u;const o=l.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),a>=o.wsize?(o.window.set(t.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(u=o.wsize-o.wnext,u>a&&(u=a),o.window.set(t.subarray(e-a,e-a+u),o.wnext),a-=u,a?(o.window.set(t.subarray(e-a,e),0),o.wnext=a,o.whave=o.wsize):(o.wnext+=u,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=u))),0},Cr=(l,t)=>{let e,a,u,o,d,h,k,g,f,v,I,m,D,R,T=0,U,Z,N,E,S,O,C,$;const X=new Uint8Array(4);let V,H;const q=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(rt(l)||!l.output||!l.input&&l.avail_in!==0)return Pe;e=l.state,e.mode===Je&&(e.mode=Vt),d=l.next_out,u=l.output,k=l.avail_out,o=l.next_in,a=l.input,h=l.avail_in,g=e.hold,f=e.bits,v=h,I=k,$=it;e:for(;;)switch(e.mode){case St:if(e.wrap===0){e.mode=Vt;break}for(;f<16;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(e.wrap&2&&g===35615){e.wbits===0&&(e.wbits=15),e.check=0,X[0]=g&255,X[1]=g>>>8&255,e.check=Ke(e.check,X,2,0),g=0,f=0,e.mode=Tn;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((g&255)<<8)+(g>>8))%31){l.msg="incorrect header check",e.mode=_e;break}if((g&15)!==Bn){l.msg="unknown compression method",e.mode=_e;break}if(g>>>=4,f-=4,C=(g&15)+8,e.wbits===0&&(e.wbits=C),C>15||C>e.wbits){l.msg="invalid window size",e.mode=_e;break}e.dmax=1<<e.wbits,e.flags=0,l.adler=e.check=1,e.mode=g&512?Mn:Je,g=0,f=0;break;case Tn:for(;f<16;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(e.flags=g,(e.flags&255)!==Bn){l.msg="unknown compression method",e.mode=_e;break}if(e.flags&57344){l.msg="unknown header flags set",e.mode=_e;break}e.head&&(e.head.text=g>>8&1),e.flags&512&&e.wrap&4&&(X[0]=g&255,X[1]=g>>>8&255,e.check=Ke(e.check,X,2,0)),g=0,f=0,e.mode=Rn;case Rn:for(;f<32;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}e.head&&(e.head.time=g),e.flags&512&&e.wrap&4&&(X[0]=g&255,X[1]=g>>>8&255,X[2]=g>>>16&255,X[3]=g>>>24&255,e.check=Ke(e.check,X,4,0)),g=0,f=0,e.mode=Sn;case Sn:for(;f<16;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}e.head&&(e.head.xflags=g&255,e.head.os=g>>8),e.flags&512&&e.wrap&4&&(X[0]=g&255,X[1]=g>>>8&255,e.check=Ke(e.check,X,2,0)),g=0,f=0,e.mode=Fn;case Fn:if(e.flags&1024){for(;f<16;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}e.length=g,e.head&&(e.head.extra_len=g),e.flags&512&&e.wrap&4&&(X[0]=g&255,X[1]=g>>>8&255,e.check=Ke(e.check,X,2,0)),g=0,f=0}else e.head&&(e.head.extra=null);e.mode=Cn;case Cn:if(e.flags&1024&&(m=e.length,m>h&&(m=h),m&&(e.head&&(C=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(a.subarray(o,o+m),C)),e.flags&512&&e.wrap&4&&(e.check=Ke(e.check,a,m,o)),h-=m,o+=m,e.length-=m),e.length))break e;e.length=0,e.mode=Nn;case Nn:if(e.flags&2048){if(h===0)break e;m=0;do C=a[o+m++],e.head&&C&&e.length<65536&&(e.head.name+=String.fromCharCode(C));while(C&&m<h);if(e.flags&512&&e.wrap&4&&(e.check=Ke(e.check,a,m,o)),h-=m,o+=m,C)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=Un;case Un:if(e.flags&4096){if(h===0)break e;m=0;do C=a[o+m++],e.head&&C&&e.length<65536&&(e.head.comment+=String.fromCharCode(C));while(C&&m<h);if(e.flags&512&&e.wrap&4&&(e.check=Ke(e.check,a,m,o)),h-=m,o+=m,C)break e}else e.head&&(e.head.comment=null);e.mode=Dn;case Dn:if(e.flags&512){for(;f<16;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(e.wrap&4&&g!==(e.check&65535)){l.msg="header crc mismatch",e.mode=_e;break}g=0,f=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),l.adler=e.check=0,e.mode=Je;break;case Mn:for(;f<32;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}l.adler=e.check=Kn(g),g=0,f=0,e.mode=Ft;case Ft:if(e.havedict===0)return l.next_out=d,l.avail_out=k,l.next_in=o,l.avail_in=h,e.hold=g,e.bits=f,vr;l.adler=e.check=1,e.mode=Je;case Je:if(t===Er||t===Rt)break e;case Vt:if(e.last){g>>>=f&7,f-=f&7,e.mode=Xt;break}for(;f<3;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}switch(e.last=g&1,g>>>=1,f-=1,g&3){case 0:e.mode=On;break;case 1:if(Fr(e),e.mode=Ct,t===Rt){g>>>=2,f-=2;break e}break;case 2:e.mode=Ln;break;case 3:l.msg="invalid block type",e.mode=_e}g>>>=2,f-=2;break;case On:for(g>>>=f&7,f-=f&7;f<32;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if((g&65535)!==(g>>>16^65535)){l.msg="invalid stored block lengths",e.mode=_e;break}if(e.length=g&65535,g=0,f=0,e.mode=$t,t===Rt)break e;case $t:e.mode=zn;case zn:if(m=e.length,m){if(m>h&&(m=h),m>k&&(m=k),m===0)break e;u.set(a.subarray(o,o+m),d),h-=m,o+=m,k-=m,d+=m,e.length-=m;break}e.mode=Je;break;case Ln:for(;f<14;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(e.nlen=(g&31)+257,g>>>=5,f-=5,e.ndist=(g&31)+1,g>>>=5,f-=5,e.ncode=(g&15)+4,g>>>=4,f-=4,e.nlen>286||e.ndist>30){l.msg="too many length or distance symbols",e.mode=_e;break}e.have=0,e.mode=Pn;case Pn:for(;e.have<e.ncode;){for(;f<3;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}e.lens[q[e.have++]]=g&7,g>>>=3,f-=3}for(;e.have<19;)e.lens[q[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,V={bits:e.lenbits},$=bt(yr,e.lens,0,19,e.lencode,0,e.work,V),e.lenbits=V.bits,$){l.msg="invalid code lengths set",e.mode=_e;break}e.have=0,e.mode=Zn;case Zn:for(;e.have<e.nlen+e.ndist;){for(;T=e.lencode[g&(1<<e.lenbits)-1],U=T>>>24,Z=T>>>16&255,N=T&65535,!(U<=f);){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(N<16)g>>>=U,f-=U,e.lens[e.have++]=N;else{if(N===16){for(H=U+2;f<H;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(g>>>=U,f-=U,e.have===0){l.msg="invalid bit length repeat",e.mode=_e;break}C=e.lens[e.have-1],m=3+(g&3),g>>>=2,f-=2}else if(N===17){for(H=U+3;f<H;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}g>>>=U,f-=U,C=0,m=3+(g&7),g>>>=3,f-=3}else{for(H=U+7;f<H;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}g>>>=U,f-=U,C=0,m=11+(g&127),g>>>=7,f-=7}if(e.have+m>e.nlen+e.ndist){l.msg="invalid bit length repeat",e.mode=_e;break}for(;m--;)e.lens[e.have++]=C}}if(e.mode===_e)break;if(e.lens[256]===0){l.msg="invalid code -- missing end-of-block",e.mode=_e;break}if(e.lenbits=9,V={bits:e.lenbits},$=bt(En,e.lens,0,e.nlen,e.lencode,0,e.work,V),e.lenbits=V.bits,$){l.msg="invalid literal/lengths set",e.mode=_e;break}if(e.distbits=6,e.distcode=e.distdyn,V={bits:e.distbits},$=bt(kn,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,V),e.distbits=V.bits,$){l.msg="invalid distances set",e.mode=_e;break}if(e.mode=Ct,t===Rt)break e;case Ct:e.mode=Nt;case Nt:if(h>=6&&k>=258){l.next_out=d,l.avail_out=k,l.next_in=o,l.avail_in=h,e.hold=g,e.bits=f,wr(l,I),d=l.next_out,u=l.output,k=l.avail_out,o=l.next_in,a=l.input,h=l.avail_in,g=e.hold,f=e.bits,e.mode===Je&&(e.back=-1);break}for(e.back=0;T=e.lencode[g&(1<<e.lenbits)-1],U=T>>>24,Z=T>>>16&255,N=T&65535,!(U<=f);){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(Z&&(Z&240)===0){for(E=U,S=Z,O=N;T=e.lencode[O+((g&(1<<E+S)-1)>>E)],U=T>>>24,Z=T>>>16&255,N=T&65535,!(E+U<=f);){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}g>>>=E,f-=E,e.back+=E}if(g>>>=U,f-=U,e.back+=U,e.length=N,Z===0){e.mode=Hn;break}if(Z&32){e.back=-1,e.mode=Je;break}if(Z&64){l.msg="invalid literal/length code",e.mode=_e;break}e.extra=Z&15,e.mode=Gn;case Gn:if(e.extra){for(H=e.extra;f<H;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}e.length+=g&(1<<e.extra)-1,g>>>=e.extra,f-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Vn;case Vn:for(;T=e.distcode[g&(1<<e.distbits)-1],U=T>>>24,Z=T>>>16&255,N=T&65535,!(U<=f);){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if((Z&240)===0){for(E=U,S=Z,O=N;T=e.distcode[O+((g&(1<<E+S)-1)>>E)],U=T>>>24,Z=T>>>16&255,N=T&65535,!(E+U<=f);){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}g>>>=E,f-=E,e.back+=E}if(g>>>=U,f-=U,e.back+=U,Z&64){l.msg="invalid distance code",e.mode=_e;break}e.offset=N,e.extra=Z&15,e.mode=$n;case $n:if(e.extra){for(H=e.extra;f<H;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}e.offset+=g&(1<<e.extra)-1,g>>>=e.extra,f-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){l.msg="invalid distance too far back",e.mode=_e;break}e.mode=Xn;case Xn:if(k===0)break e;if(m=I-k,e.offset>m){if(m=e.offset-m,m>e.whave&&e.sane){l.msg="invalid distance too far back",e.mode=_e;break}m>e.wnext?(m-=e.wnext,D=e.wsize-m):D=e.wnext-m,m>e.length&&(m=e.length),R=e.window}else R=u,D=d-e.offset,m=e.length;m>k&&(m=k),k-=m,e.length-=m;do u[d++]=R[D++];while(--m);e.length===0&&(e.mode=Nt);break;case Hn:if(k===0)break e;u[d++]=e.length,k--,e.mode=Nt;break;case Xt:if(e.wrap){for(;f<32;){if(h===0)break e;h--,g|=a[o++]<<f,f+=8}if(I-=k,l.total_out+=I,e.total+=I,e.wrap&4&&I&&(l.adler=e.check=e.flags?Ke(e.check,u,I,d-I):Lt(e.check,u,I,d-I)),I=k,e.wrap&4&&(e.flags?g:Kn(g))!==e.check){l.msg="incorrect data check",e.mode=_e;break}g=0,f=0}e.mode=Wn;case Wn:if(e.wrap&&e.flags){for(;f<32;){if(h===0)break e;h--,g+=a[o++]<<f,f+=8}if(e.wrap&4&&g!==(e.total&4294967295)){l.msg="incorrect length check",e.mode=_e;break}g=0,f=0}e.mode=jn;case jn:$=kr;break e;case _e:$=In;break e;case qn:return An;case Yn:default:return Pe}return l.next_out=d,l.avail_out=k,l.next_in=o,l.avail_in=h,e.hold=g,e.bits=f,(e.wsize||I!==l.avail_out&&e.mode<_e&&(e.mode<Xt||t!==vn))&&ii(l,l.output,l.next_out,I-l.avail_out),v-=l.avail_in,I-=l.avail_out,l.total_in+=v,l.total_out+=I,e.total+=I,e.wrap&4&&I&&(l.adler=e.check=e.flags?Ke(e.check,u,I,l.next_out-I):Lt(e.check,u,I,l.next_out-I)),l.data_type=e.bits+(e.last?64:0)+(e.mode===Je?128:0)+(e.mode===Ct||e.mode===$t?256:0),(v===0&&I===0||t===vn)&&$===it&&($=Ir),$},Nr=l=>{if(rt(l))return Pe;let t=l.state;return t.window&&(t.window=null),l.state=null,it},Ur=(l,t)=>{if(rt(l))return Pe;const e=l.state;return(e.wrap&2)===0?Pe:(e.head=t,t.done=!1,it)},Dr=(l,t)=>{const e=t.length;let a,u,o;return rt(l)||(a=l.state,a.wrap!==0&&a.mode!==Ft)?Pe:a.mode===Ft&&(u=1,u=Lt(u,t,e,0),u!==a.check)?In:(o=ii(l,t,e,e),o?(a.mode=qn,An):(a.havedict=1,it))};var Mr=Jn,Or=ei,zr=Qn,Lr=Sr,Pr=ti,Zr=Cr,Gr=Nr,Vr=Ur,$r=Dr,Xr="pako inflate (from Nodeca project)",et={inflateReset:Mr,inflateReset2:Or,inflateResetKeep:zr,inflateInit:Lr,inflateInit2:Pr,inflate:Zr,inflateEnd:Gr,inflateGetHeader:Vr,inflateSetDictionary:$r,inflateInfo:Xr};function Hr(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Wr=Hr;const ri=Object.prototype.toString,{Z_NO_FLUSH:jr,Z_FINISH:qr,Z_OK:mt,Z_STREAM_END:jt,Z_NEED_DICT:qt,Z_STREAM_ERROR:Yr,Z_DATA_ERROR:oi,Z_MEM_ERROR:Kr}=_n;function Ut(l){this.options=wn.assign({chunkSize:1024*64,windowBits:15,to:""},l||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(l&&l.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new pr,this.strm.avail_out=0;let e=et.inflateInit2(this.strm,t.windowBits);if(e!==mt)throw new Error(Pt[e]);if(this.header=new Wr,et.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Zt.string2buf(t.dictionary):ri.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=et.inflateSetDictionary(this.strm,t.dictionary),e!==mt)))throw new Error(Pt[e])}Ut.prototype.push=function(l,t){const e=this.strm,a=this.options.chunkSize,u=this.options.dictionary;let o,d,h;if(this.ended)return!1;for(t===~~t?d=t:d=t===!0?qr:jr,ri.call(l)==="[object ArrayBuffer]"?e.input=new Uint8Array(l):e.input=l,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(a),e.next_out=0,e.avail_out=a),o=et.inflate(e,d),o===qt&&u&&(o=et.inflateSetDictionary(e,u),o===mt?o=et.inflate(e,d):o===oi&&(o=qt));e.avail_in>0&&o===jt&&e.state.wrap>0&&l[e.next_in]!==0;)et.inflateReset(e),o=et.inflate(e,d);switch(o){case Yr:case oi:case qt:case Kr:return this.onEnd(o),this.ended=!0,!1}if(h=e.avail_out,e.next_out&&(e.avail_out===0||o===jt))if(this.options.to==="string"){let k=Zt.utf8border(e.output,e.next_out),g=e.next_out-k,f=Zt.buf2string(e.output,k);e.next_out=g,e.avail_out=a-g,g&&e.output.set(e.output.subarray(k,k+g),0),this.onData(f)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(o===mt&&h===0)){if(o===jt)return o=et.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},Ut.prototype.onData=function(l){this.chunks.push(l)},Ut.prototype.onEnd=function(l){l===mt&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=wn.flattenChunks(this.chunks)),this.chunks=[],this.err=l,this.msg=this.strm.msg};function Qr(l,t){const e=new Ut(t);if(e.push(l),e.err)throw e.msg||Pt[e.err];return e.result}var Jr=Qr,eo={inflate:Jr};const{inflate:to}=eo;var no=to;const Yt=Uint8Array.from("Kaydara FBX Binary  \0\0".split(""),function(l){return l.charCodeAt(0)});function io(l){if(l.length<Yt.length)throw"Not a binary FBX file";const t=new ut.BinaryReader(l);if(!t.readUint8Array(Yt.length).every(function(d,h){return d===Yt[h]}))throw"Not a binary FBX file";const u=t.readUint32()>=7500,o=[];for(;;){const d=ai(t,u);if(d===null)break;o.push(d)}return o}function ai(l,t){const e=t?Number(l.readUint64()):l.readUint32();if(e===0)return null;const a=t?Number(l.readUint64()):l.readUint32();t?Number(l.readUint64()):l.readUint32();const u=l.readUint8(),d={name:l.readArrayAsString(u),props:[],nodes:[]};for(var h=0;h<a;++h)d.props.push(ro(l));for(;e-l.offset>13;){const k=ai(l,t);k!==null&&d.nodes.push(k)}return l.offset=e,d}const si={Y:function(l){return l.readInt16()},C:function(l){return l.readUint8AsBool()},I:function(l){return l.readInt32()},F:function(l){return l.readFloat32()},D:function(l){return l.readFloat64()},L:function(l){return l.readInt64()},f:function(l){return xt(l,function(t){return t.readFloat32()})},d:function(l){return xt(l,function(t){return t.readFloat64()})},l:function(l){return xt(l,function(t){return t.readInt64()})},i:function(l){return xt(l,function(t){return t.readInt32()})},b:function(l){return xt(l,function(t){return t.readUint8AsBool()})},S:function(l){return l.readArrayAsString(l.readUint32())},R:function(l){return l.readUint8Array(l.readUint32())}};function ro(l){const t=l.readUint8AsString();if(typeof si[t]>"u")throw"Unknown Property Type "+t.charCodeAt(0);let e=si[t](l);return t==="S"&&e.indexOf("\0")!=-1&&(e=e.split("\0").reverse().join("::")),e}function xt(l,t){const e=l.readUint32(),a=l.readUint32(),u=l.readUint32();let o=new ut.BinaryReader(l.readUint8Array(u));a==1&&(o=new ut.BinaryReader(no(o.binary)));const d=[];for(let h=0;h<e;++h)d.push(t(o));return d}var Kt={},yt={},Et={},fi;function oo(){if(fi)return Et;fi=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.BinaryReader=void 0;class l{constructor(e){this.offset=0,this.binary=e}readUint8(){return this.binary[this.offset++].valueOf()}readUint8AsString(){return String.fromCharCode(this.binary[this.offset++].valueOf())}readUint8AsBool(){return this.binary[this.offset++].valueOf()!==0}readUint16(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,2).getUint16(0,!0);return this.offset+=2,e}readUint32(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,4).getUint32(0,!0);return this.offset+=4,e}readUint64(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,8).getBigUint64(0,!0);return this.offset+=8,e}readInt8(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,1).getInt8(0);return this.offset+=1,e}readInt16(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,2).getInt16(0,!0);return this.offset+=2,e}readInt32(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,4).getInt32(0,!0);return this.offset+=4,e}readInt64(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,8).getBigInt64(0,!0);return this.offset+=8,e}readFloat32(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,4).getFloat32(0,!0);return this.offset+=4,e}readFloat64(){const e=new DataView(this.binary.buffer,this.binary.byteOffset+this.offset,8).getFloat64(0,!0);return this.offset+=8,e}readUint8Array(e){return this.binary.subarray(this.offset,this.offset+=e)}readArrayAsString(e){return String.fromCharCode.apply(null,this.binary.subarray(this.offset,this.offset+=e))}}return Et.BinaryReader=l,Et}var He={},ot={},We={},at={},li;function ao(){if(li)return at;li=1;const l=4,t=0,e=1,a=2;function u(w){let s=w.length;for(;--s>=0;)w[s]=0}const o=0,d=1,h=2,k=3,g=258,f=29,v=256,I=v+1+f,m=30,D=19,R=2*I+1,T=15,U=16,Z=7,N=256,E=16,S=17,O=18,C=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),$=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),X=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),V=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),H=512,q=new Array((I+2)*2);u(q);const J=new Array(m*2);u(J);const se=new Array(H);u(se);const ue=new Array(g-k+1);u(ue);const ke=new Array(f);u(ke);const ve=new Array(m);u(ve);function ye(w,s,n,r,_){this.static_tree=w,this.extra_bits=s,this.extra_base=n,this.elems=r,this.max_length=_,this.has_stree=w&&w.length}let Ce,te,fe;function le(w,s){this.dyn_tree=w,this.max_code=0,this.stat_desc=s}const Ne=w=>w<256?se[w]:se[256+(w>>>7)],oe=(w,s)=>{w.pending_buf[w.pending++]=s&255,w.pending_buf[w.pending++]=s>>>8&255},ie=(w,s,n)=>{w.bi_valid>U-n?(w.bi_buf|=s<<w.bi_valid&65535,oe(w,w.bi_buf),w.bi_buf=s>>U-w.bi_valid,w.bi_valid+=n-U):(w.bi_buf|=s<<w.bi_valid&65535,w.bi_valid+=n)},he=(w,s,n)=>{ie(w,n[s*2],n[s*2+1])},Ge=(w,s)=>{let n=0;do n|=w&1,w>>>=1,n<<=1;while(--s>0);return n>>>1},Ve=w=>{w.bi_valid===16?(oe(w,w.bi_buf),w.bi_buf=0,w.bi_valid=0):w.bi_valid>=8&&(w.pending_buf[w.pending++]=w.bi_buf&255,w.bi_buf>>=8,w.bi_valid-=8)},je=(w,s)=>{const n=s.dyn_tree,r=s.max_code,_=s.stat_desc.static_tree,x=s.stat_desc.has_stree,p=s.stat_desc.extra_bits,y=s.stat_desc.extra_base,c=s.stat_desc.max_length;let L,K,P,Q,j,ce,M=0;for(Q=0;Q<=T;Q++)w.bl_count[Q]=0;for(n[w.heap[w.heap_max]*2+1]=0,L=w.heap_max+1;L<R;L++)K=w.heap[L],Q=n[n[K*2+1]*2+1]+1,Q>c&&(Q=c,M++),n[K*2+1]=Q,!(K>r)&&(w.bl_count[Q]++,j=0,K>=y&&(j=p[K-y]),ce=n[K*2],w.opt_len+=ce*(Q+j),x&&(w.static_len+=ce*(_[K*2+1]+j)));if(M!==0){do{for(Q=c-1;w.bl_count[Q]===0;)Q--;w.bl_count[Q]--,w.bl_count[Q+1]+=2,w.bl_count[c]--,M-=2}while(M>0);for(Q=c;Q!==0;Q--)for(K=w.bl_count[Q];K!==0;)P=w.heap[--L],!(P>r)&&(n[P*2+1]!==Q&&(w.opt_len+=(Q-n[P*2+1])*n[P*2],n[P*2+1]=Q),K--)}},Ie=(w,s,n)=>{const r=new Array(T+1);let _=0,x,p;for(x=1;x<=T;x++)_=_+n[x-1]<<1,r[x]=_;for(p=0;p<=s;p++){let y=w[p*2+1];y!==0&&(w[p*2]=Ge(r[y]++,y))}},re=()=>{let w,s,n,r,_;const x=new Array(T+1);for(n=0,r=0;r<f-1;r++)for(ke[r]=n,w=0;w<1<<C[r];w++)ue[n++]=r;for(ue[n-1]=r,_=0,r=0;r<16;r++)for(ve[r]=_,w=0;w<1<<$[r];w++)se[_++]=r;for(_>>=7;r<m;r++)for(ve[r]=_<<7,w=0;w<1<<$[r]-7;w++)se[256+_++]=r;for(s=0;s<=T;s++)x[s]=0;for(w=0;w<=143;)q[w*2+1]=8,w++,x[8]++;for(;w<=255;)q[w*2+1]=9,w++,x[9]++;for(;w<=279;)q[w*2+1]=7,w++,x[7]++;for(;w<=287;)q[w*2+1]=8,w++,x[8]++;for(Ie(q,I+1,x),w=0;w<m;w++)J[w*2+1]=5,J[w*2]=Ge(w,5);Ce=new ye(q,C,v+1,I,T),te=new ye(J,$,0,m,T),fe=new ye(new Array(0),X,0,D,Z)},de=w=>{let s;for(s=0;s<I;s++)w.dyn_ltree[s*2]=0;for(s=0;s<m;s++)w.dyn_dtree[s*2]=0;for(s=0;s<D;s++)w.bl_tree[s*2]=0;w.dyn_ltree[N*2]=1,w.opt_len=w.static_len=0,w.sym_next=w.matches=0},Ae=w=>{w.bi_valid>8?oe(w,w.bi_buf):w.bi_valid>0&&(w.pending_buf[w.pending++]=w.bi_buf),w.bi_buf=0,w.bi_valid=0},Ue=(w,s,n,r)=>{const _=s*2,x=n*2;return w[_]<w[x]||w[_]===w[x]&&r[s]<=r[n]},Be=(w,s,n)=>{const r=w.heap[n];let _=n<<1;for(;_<=w.heap_len&&(_<w.heap_len&&Ue(s,w.heap[_+1],w.heap[_],w.depth)&&_++,!Ue(s,r,w.heap[_],w.depth));)w.heap[n]=w.heap[_],n=_,_<<=1;w.heap[n]=r},$e=(w,s,n)=>{let r,_,x=0,p,y;if(w.sym_next!==0)do r=w.pending_buf[w.sym_buf+x++]&255,r+=(w.pending_buf[w.sym_buf+x++]&255)<<8,_=w.pending_buf[w.sym_buf+x++],r===0?he(w,_,s):(p=ue[_],he(w,p+v+1,s),y=C[p],y!==0&&(_-=ke[p],ie(w,_,y)),r--,p=Ne(r),he(w,p,n),y=$[p],y!==0&&(r-=ve[p],ie(w,r,y)));while(x<w.sym_next);he(w,N,s)},xe=(w,s)=>{const n=s.dyn_tree,r=s.stat_desc.static_tree,_=s.stat_desc.has_stree,x=s.stat_desc.elems;let p,y,c=-1,L;for(w.heap_len=0,w.heap_max=R,p=0;p<x;p++)n[p*2]!==0?(w.heap[++w.heap_len]=c=p,w.depth[p]=0):n[p*2+1]=0;for(;w.heap_len<2;)L=w.heap[++w.heap_len]=c<2?++c:0,n[L*2]=1,w.depth[L]=0,w.opt_len--,_&&(w.static_len-=r[L*2+1]);for(s.max_code=c,p=w.heap_len>>1;p>=1;p--)Be(w,n,p);L=x;do p=w.heap[1],w.heap[1]=w.heap[w.heap_len--],Be(w,n,1),y=w.heap[1],w.heap[--w.heap_max]=p,w.heap[--w.heap_max]=y,n[L*2]=n[p*2]+n[y*2],w.depth[L]=(w.depth[p]>=w.depth[y]?w.depth[p]:w.depth[y])+1,n[p*2+1]=n[y*2+1]=L,w.heap[1]=L++,Be(w,n,1);while(w.heap_len>=2);w.heap[--w.heap_max]=w.heap[1],je(w,s),Ie(n,c,w.bl_count)},Qe=(w,s,n)=>{let r,_=-1,x,p=s[1],y=0,c=7,L=4;for(p===0&&(c=138,L=3),s[(n+1)*2+1]=65535,r=0;r<=n;r++)x=p,p=s[(r+1)*2+1],!(++y<c&&x===p)&&(y<L?w.bl_tree[x*2]+=y:x!==0?(x!==_&&w.bl_tree[x*2]++,w.bl_tree[E*2]++):y<=10?w.bl_tree[S*2]++:w.bl_tree[O*2]++,y=0,_=x,p===0?(c=138,L=3):x===p?(c=6,L=3):(c=7,L=4))},Te=(w,s,n)=>{let r,_=-1,x,p=s[1],y=0,c=7,L=4;for(p===0&&(c=138,L=3),r=0;r<=n;r++)if(x=p,p=s[(r+1)*2+1],!(++y<c&&x===p)){if(y<L)do he(w,x,w.bl_tree);while(--y!==0);else x!==0?(x!==_&&(he(w,x,w.bl_tree),y--),he(w,E,w.bl_tree),ie(w,y-3,2)):y<=10?(he(w,S,w.bl_tree),ie(w,y-3,3)):(he(w,O,w.bl_tree),ie(w,y-11,7));y=0,_=x,p===0?(c=138,L=3):x===p?(c=6,L=3):(c=7,L=4)}},Re=w=>{let s;for(Qe(w,w.dyn_ltree,w.l_desc.max_code),Qe(w,w.dyn_dtree,w.d_desc.max_code),xe(w,w.bl_desc),s=D-1;s>=3&&w.bl_tree[V[s]*2+1]===0;s--);return w.opt_len+=3*(s+1)+5+5+4,s},lt=(w,s,n,r)=>{let _;for(ie(w,s-257,5),ie(w,n-1,5),ie(w,r-4,4),_=0;_<r;_++)ie(w,w.bl_tree[V[_]*2+1],3);Te(w,w.dyn_ltree,s-1),Te(w,w.dyn_dtree,n-1)},Se=w=>{let s=4093624447,n;for(n=0;n<=31;n++,s>>>=1)if(s&1&&w.dyn_ltree[n*2]!==0)return t;if(w.dyn_ltree[18]!==0||w.dyn_ltree[20]!==0||w.dyn_ltree[26]!==0)return e;for(n=32;n<v;n++)if(w.dyn_ltree[n*2]!==0)return e;return t};let ge=!1;const we=w=>{ge||(re(),ge=!0),w.l_desc=new le(w.dyn_ltree,Ce),w.d_desc=new le(w.dyn_dtree,te),w.bl_desc=new le(w.bl_tree,fe),w.bi_buf=0,w.bi_valid=0,de(w)},ne=(w,s,n,r)=>{ie(w,(o<<1)+(r?1:0),3),Ae(w),oe(w,n),oe(w,~n),n&&w.pending_buf.set(w.window.subarray(s,s+n),w.pending),w.pending+=n},De=w=>{ie(w,d<<1,3),he(w,N,q),Ve(w)},qe=(w,s,n,r)=>{let _,x,p=0;w.level>0?(w.strm.data_type===a&&(w.strm.data_type=Se(w)),xe(w,w.l_desc),xe(w,w.d_desc),p=Re(w),_=w.opt_len+3+7>>>3,x=w.static_len+3+7>>>3,x<=_&&(_=x)):_=x=n+5,n+4<=_&&s!==-1?ne(w,s,n,r):w.strategy===l||x===_?(ie(w,(d<<1)+(r?1:0),3),$e(w,q,J)):(ie(w,(h<<1)+(r?1:0),3),lt(w,w.l_desc.max_code+1,w.d_desc.max_code+1,p+1),$e(w,w.dyn_ltree,w.dyn_dtree)),de(w),r&&Ae(w)},Ee=(w,s,n)=>(w.pending_buf[w.sym_buf+w.sym_next++]=s,w.pending_buf[w.sym_buf+w.sym_next++]=s>>8,w.pending_buf[w.sym_buf+w.sym_next++]=n,s===0?w.dyn_ltree[n*2]++:(w.matches++,s--,w.dyn_ltree[(ue[n]+v+1)*2]++,w.dyn_dtree[Ne(s)*2]++),w.sym_next===w.sym_end);return at._tr_init=we,at._tr_stored_block=ne,at._tr_flush_block=qe,at._tr_tally=Ee,at._tr_align=De,at}var Qt,ci;function ui(){return ci||(ci=1,Qt=(t,e,a,u)=>{let o=t&65535|0,d=t>>>16&65535|0,h=0;for(;a!==0;){h=a>2e3?2e3:a,a-=h;do o=o+e[u++]|0,d=d+o|0;while(--h);o%=65521,d%=65521}return o|d<<16|0}),Qt}var Jt,hi;function di(){if(hi)return Jt;hi=1;const l=()=>{let a,u=[];for(var o=0;o<256;o++){a=o;for(var d=0;d<8;d++)a=a&1?3988292384^a>>>1:a>>>1;u[o]=a}return u},t=new Uint32Array(l());return Jt=(a,u,o,d)=>{const h=t,k=d+o;a^=-1;for(let g=d;g<k;g++)a=a>>>8^h[(a^u[g])&255];return a^-1},Jt}var en,pi;function tn(){return pi||(pi=1,en={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),en}var nn,_i;function st(){return _i||(_i=1,nn={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),nn}var wi;function so(){if(wi)return We;wi=1;const{_tr_init:l,_tr_stored_block:t,_tr_flush_block:e,_tr_tally:a,_tr_align:u}=ao(),o=ui(),d=di(),h=tn(),{Z_NO_FLUSH:k,Z_PARTIAL_FLUSH:g,Z_FULL_FLUSH:f,Z_FINISH:v,Z_BLOCK:I,Z_OK:m,Z_STREAM_END:D,Z_STREAM_ERROR:R,Z_DATA_ERROR:T,Z_BUF_ERROR:U,Z_DEFAULT_COMPRESSION:Z,Z_FILTERED:N,Z_HUFFMAN_ONLY:E,Z_RLE:S,Z_FIXED:O,Z_DEFAULT_STRATEGY:C,Z_UNKNOWN:$,Z_DEFLATED:X}=st(),V=9,H=15,q=8,ue=256+1+29,ke=30,ve=19,ye=2*ue+1,Ce=15,te=3,fe=258,le=fe+te+1,Ne=32,oe=42,ie=57,he=69,Ge=73,Ve=91,je=103,Ie=113,re=666,de=1,Ae=2,Ue=3,Be=4,$e=3,xe=(i,F)=>(i.msg=h[F],F),Qe=i=>i*2-(i>4?9:0),Te=i=>{let F=i.length;for(;--F>=0;)i[F]=0},Re=i=>{let F,b,A,B=i.w_size;F=i.hash_size,A=F;do b=i.head[--A],i.head[A]=b>=B?b-B:0;while(--F);F=B,A=F;do b=i.prev[--A],i.prev[A]=b>=B?b-B:0;while(--F)};let Se=(i,F,b)=>(F<<i.hash_shift^b)&i.hash_mask;const ge=i=>{const F=i.state;let b=F.pending;b>i.avail_out&&(b=i.avail_out),b!==0&&(i.output.set(F.pending_buf.subarray(F.pending_out,F.pending_out+b),i.next_out),i.next_out+=b,F.pending_out+=b,i.total_out+=b,i.avail_out-=b,F.pending-=b,F.pending===0&&(F.pending_out=0))},we=(i,F)=>{e(i,i.block_start>=0?i.block_start:-1,i.strstart-i.block_start,F),i.block_start=i.strstart,ge(i.strm)},ne=(i,F)=>{i.pending_buf[i.pending++]=F},De=(i,F)=>{i.pending_buf[i.pending++]=F>>>8&255,i.pending_buf[i.pending++]=F&255},qe=(i,F,b,A)=>{let B=i.avail_in;return B>A&&(B=A),B===0?0:(i.avail_in-=B,F.set(i.input.subarray(i.next_in,i.next_in+B),b),i.state.wrap===1?i.adler=o(i.adler,F,B,b):i.state.wrap===2&&(i.adler=d(i.adler,F,B,b)),i.next_in+=B,i.total_in+=B,B)},Ee=(i,F)=>{let b=i.max_chain_length,A=i.strstart,B,W,ee=i.prev_length,Y=i.nice_match;const Fe=i.strstart>i.w_size-le?i.strstart-(i.w_size-le):0,ae=i.window,be=i.w_mask,Me=i.prev,me=i.strstart+fe;let Xe=ae[A+ee-1],ze=ae[A+ee];i.prev_length>=i.good_match&&(b>>=2),Y>i.lookahead&&(Y=i.lookahead);do if(B=F,!(ae[B+ee]!==ze||ae[B+ee-1]!==Xe||ae[B]!==ae[A]||ae[++B]!==ae[A+1])){A+=2,B++;do;while(ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&ae[++A]===ae[++B]&&A<me);if(W=fe-(me-A),A=me-fe,W>ee){if(i.match_start=F,ee=W,W>=Y)break;Xe=ae[A+ee-1],ze=ae[A+ee]}}while((F=Me[F&be])>Fe&&--b!==0);return ee<=i.lookahead?ee:i.lookahead},w=i=>{const F=i.w_size;let b,A,B;do{if(A=i.window_size-i.lookahead-i.strstart,i.strstart>=F+(F-le)&&(i.window.set(i.window.subarray(F,F+F-A),0),i.match_start-=F,i.strstart-=F,i.block_start-=F,i.insert>i.strstart&&(i.insert=i.strstart),Re(i),A+=F),i.strm.avail_in===0)break;if(b=qe(i.strm,i.window,i.strstart+i.lookahead,A),i.lookahead+=b,i.lookahead+i.insert>=te)for(B=i.strstart-i.insert,i.ins_h=i.window[B],i.ins_h=Se(i,i.ins_h,i.window[B+1]);i.insert&&(i.ins_h=Se(i,i.ins_h,i.window[B+te-1]),i.prev[B&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=B,B++,i.insert--,!(i.lookahead+i.insert<te)););}while(i.lookahead<le&&i.strm.avail_in!==0)},s=(i,F)=>{let b=i.pending_buf_size-5>i.w_size?i.w_size:i.pending_buf_size-5,A,B,W,ee=0,Y=i.strm.avail_in;do{if(A=65535,W=i.bi_valid+42>>3,i.strm.avail_out<W||(W=i.strm.avail_out-W,B=i.strstart-i.block_start,A>B+i.strm.avail_in&&(A=B+i.strm.avail_in),A>W&&(A=W),A<b&&(A===0&&F!==v||F===k||A!==B+i.strm.avail_in)))break;ee=F===v&&A===B+i.strm.avail_in?1:0,t(i,0,0,ee),i.pending_buf[i.pending-4]=A,i.pending_buf[i.pending-3]=A>>8,i.pending_buf[i.pending-2]=~A,i.pending_buf[i.pending-1]=~A>>8,ge(i.strm),B&&(B>A&&(B=A),i.strm.output.set(i.window.subarray(i.block_start,i.block_start+B),i.strm.next_out),i.strm.next_out+=B,i.strm.avail_out-=B,i.strm.total_out+=B,i.block_start+=B,A-=B),A&&(qe(i.strm,i.strm.output,i.strm.next_out,A),i.strm.next_out+=A,i.strm.avail_out-=A,i.strm.total_out+=A)}while(ee===0);return Y-=i.strm.avail_in,Y&&(Y>=i.w_size?(i.matches=2,i.window.set(i.strm.input.subarray(i.strm.next_in-i.w_size,i.strm.next_in),0),i.strstart=i.w_size,i.insert=i.strstart):(i.window_size-i.strstart<=Y&&(i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,i.insert>i.strstart&&(i.insert=i.strstart)),i.window.set(i.strm.input.subarray(i.strm.next_in-Y,i.strm.next_in),i.strstart),i.strstart+=Y,i.insert+=Y>i.w_size-i.insert?i.w_size-i.insert:Y),i.block_start=i.strstart),i.high_water<i.strstart&&(i.high_water=i.strstart),ee?Be:F!==k&&F!==v&&i.strm.avail_in===0&&i.strstart===i.block_start?Ae:(W=i.window_size-i.strstart,i.strm.avail_in>W&&i.block_start>=i.w_size&&(i.block_start-=i.w_size,i.strstart-=i.w_size,i.window.set(i.window.subarray(i.w_size,i.w_size+i.strstart),0),i.matches<2&&i.matches++,W+=i.w_size,i.insert>i.strstart&&(i.insert=i.strstart)),W>i.strm.avail_in&&(W=i.strm.avail_in),W&&(qe(i.strm,i.window,i.strstart,W),i.strstart+=W,i.insert+=W>i.w_size-i.insert?i.w_size-i.insert:W),i.high_water<i.strstart&&(i.high_water=i.strstart),W=i.bi_valid+42>>3,W=i.pending_buf_size-W>65535?65535:i.pending_buf_size-W,b=W>i.w_size?i.w_size:W,B=i.strstart-i.block_start,(B>=b||(B||F===v)&&F!==k&&i.strm.avail_in===0&&B<=W)&&(A=B>W?W:B,ee=F===v&&i.strm.avail_in===0&&A===B?1:0,t(i,i.block_start,A,ee),i.block_start+=A,ge(i.strm)),ee?Ue:de)},n=(i,F)=>{let b,A;for(;;){if(i.lookahead<le){if(w(i),i.lookahead<le&&F===k)return de;if(i.lookahead===0)break}if(b=0,i.lookahead>=te&&(i.ins_h=Se(i,i.ins_h,i.window[i.strstart+te-1]),b=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),b!==0&&i.strstart-b<=i.w_size-le&&(i.match_length=Ee(i,b)),i.match_length>=te)if(A=a(i,i.strstart-i.match_start,i.match_length-te),i.lookahead-=i.match_length,i.match_length<=i.max_lazy_match&&i.lookahead>=te){i.match_length--;do i.strstart++,i.ins_h=Se(i,i.ins_h,i.window[i.strstart+te-1]),b=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart;while(--i.match_length!==0);i.strstart++}else i.strstart+=i.match_length,i.match_length=0,i.ins_h=i.window[i.strstart],i.ins_h=Se(i,i.ins_h,i.window[i.strstart+1]);else A=a(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++;if(A&&(we(i,!1),i.strm.avail_out===0))return de}return i.insert=i.strstart<te-1?i.strstart:te-1,F===v?(we(i,!0),i.strm.avail_out===0?Ue:Be):i.sym_next&&(we(i,!1),i.strm.avail_out===0)?de:Ae},r=(i,F)=>{let b,A,B;for(;;){if(i.lookahead<le){if(w(i),i.lookahead<le&&F===k)return de;if(i.lookahead===0)break}if(b=0,i.lookahead>=te&&(i.ins_h=Se(i,i.ins_h,i.window[i.strstart+te-1]),b=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart),i.prev_length=i.match_length,i.prev_match=i.match_start,i.match_length=te-1,b!==0&&i.prev_length<i.max_lazy_match&&i.strstart-b<=i.w_size-le&&(i.match_length=Ee(i,b),i.match_length<=5&&(i.strategy===N||i.match_length===te&&i.strstart-i.match_start>4096)&&(i.match_length=te-1)),i.prev_length>=te&&i.match_length<=i.prev_length){B=i.strstart+i.lookahead-te,A=a(i,i.strstart-1-i.prev_match,i.prev_length-te),i.lookahead-=i.prev_length-1,i.prev_length-=2;do++i.strstart<=B&&(i.ins_h=Se(i,i.ins_h,i.window[i.strstart+te-1]),b=i.prev[i.strstart&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=i.strstart);while(--i.prev_length!==0);if(i.match_available=0,i.match_length=te-1,i.strstart++,A&&(we(i,!1),i.strm.avail_out===0))return de}else if(i.match_available){if(A=a(i,0,i.window[i.strstart-1]),A&&we(i,!1),i.strstart++,i.lookahead--,i.strm.avail_out===0)return de}else i.match_available=1,i.strstart++,i.lookahead--}return i.match_available&&(A=a(i,0,i.window[i.strstart-1]),i.match_available=0),i.insert=i.strstart<te-1?i.strstart:te-1,F===v?(we(i,!0),i.strm.avail_out===0?Ue:Be):i.sym_next&&(we(i,!1),i.strm.avail_out===0)?de:Ae},_=(i,F)=>{let b,A,B,W;const ee=i.window;for(;;){if(i.lookahead<=fe){if(w(i),i.lookahead<=fe&&F===k)return de;if(i.lookahead===0)break}if(i.match_length=0,i.lookahead>=te&&i.strstart>0&&(B=i.strstart-1,A=ee[B],A===ee[++B]&&A===ee[++B]&&A===ee[++B])){W=i.strstart+fe;do;while(A===ee[++B]&&A===ee[++B]&&A===ee[++B]&&A===ee[++B]&&A===ee[++B]&&A===ee[++B]&&A===ee[++B]&&A===ee[++B]&&B<W);i.match_length=fe-(W-B),i.match_length>i.lookahead&&(i.match_length=i.lookahead)}if(i.match_length>=te?(b=a(i,1,i.match_length-te),i.lookahead-=i.match_length,i.strstart+=i.match_length,i.match_length=0):(b=a(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++),b&&(we(i,!1),i.strm.avail_out===0))return de}return i.insert=0,F===v?(we(i,!0),i.strm.avail_out===0?Ue:Be):i.sym_next&&(we(i,!1),i.strm.avail_out===0)?de:Ae},x=(i,F)=>{let b;for(;;){if(i.lookahead===0&&(w(i),i.lookahead===0)){if(F===k)return de;break}if(i.match_length=0,b=a(i,0,i.window[i.strstart]),i.lookahead--,i.strstart++,b&&(we(i,!1),i.strm.avail_out===0))return de}return i.insert=0,F===v?(we(i,!0),i.strm.avail_out===0?Ue:Be):i.sym_next&&(we(i,!1),i.strm.avail_out===0)?de:Ae};function p(i,F,b,A,B){this.good_length=i,this.max_lazy=F,this.nice_length=b,this.max_chain=A,this.func=B}const y=[new p(0,0,0,0,s),new p(4,4,8,4,n),new p(4,5,16,8,n),new p(4,6,32,32,n),new p(4,4,16,16,r),new p(8,16,32,32,r),new p(8,16,128,128,r),new p(8,32,128,256,r),new p(32,128,258,1024,r),new p(32,258,258,4096,r)],c=i=>{i.window_size=2*i.w_size,Te(i.head),i.max_lazy_match=y[i.level].max_lazy,i.good_match=y[i.level].good_length,i.nice_match=y[i.level].nice_length,i.max_chain_length=y[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=te-1,i.match_available=0,i.ins_h=0};function L(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=X,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ye*2),this.dyn_dtree=new Uint16Array((2*ke+1)*2),this.bl_tree=new Uint16Array((2*ve+1)*2),Te(this.dyn_ltree),Te(this.dyn_dtree),Te(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Ce+1),this.heap=new Uint16Array(2*ue+1),Te(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*ue+1),Te(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const K=i=>{if(!i)return 1;const F=i.state;return!F||F.strm!==i||F.status!==oe&&F.status!==ie&&F.status!==he&&F.status!==Ge&&F.status!==Ve&&F.status!==je&&F.status!==Ie&&F.status!==re?1:0},P=i=>{if(K(i))return xe(i,R);i.total_in=i.total_out=0,i.data_type=$;const F=i.state;return F.pending=0,F.pending_out=0,F.wrap<0&&(F.wrap=-F.wrap),F.status=F.wrap===2?ie:F.wrap?oe:Ie,i.adler=F.wrap===2?0:1,F.last_flush=-2,l(F),m},Q=i=>{const F=P(i);return F===m&&c(i.state),F},j=(i,F)=>K(i)||i.state.wrap!==2?R:(i.state.gzhead=F,m),ce=(i,F,b,A,B,W)=>{if(!i)return R;let ee=1;if(F===Z&&(F=6),A<0?(ee=0,A=-A):A>15&&(ee=2,A-=16),B<1||B>V||b!==X||A<8||A>15||F<0||F>9||W<0||W>O||A===8&&ee!==1)return xe(i,R);A===8&&(A=9);const Y=new L;return i.state=Y,Y.strm=i,Y.status=oe,Y.wrap=ee,Y.gzhead=null,Y.w_bits=A,Y.w_size=1<<Y.w_bits,Y.w_mask=Y.w_size-1,Y.hash_bits=B+7,Y.hash_size=1<<Y.hash_bits,Y.hash_mask=Y.hash_size-1,Y.hash_shift=~~((Y.hash_bits+te-1)/te),Y.window=new Uint8Array(Y.w_size*2),Y.head=new Uint16Array(Y.hash_size),Y.prev=new Uint16Array(Y.w_size),Y.lit_bufsize=1<<B+6,Y.pending_buf_size=Y.lit_bufsize*4,Y.pending_buf=new Uint8Array(Y.pending_buf_size),Y.sym_buf=Y.lit_bufsize,Y.sym_end=(Y.lit_bufsize-1)*3,Y.level=F,Y.strategy=W,Y.method=b,Q(i)},M=(i,F)=>ce(i,F,X,H,q,C),z=(i,F)=>{if(K(i)||F>I||F<0)return i?xe(i,R):R;const b=i.state;if(!i.output||i.avail_in!==0&&!i.input||b.status===re&&F!==v)return xe(i,i.avail_out===0?U:R);const A=b.last_flush;if(b.last_flush=F,b.pending!==0){if(ge(i),i.avail_out===0)return b.last_flush=-1,m}else if(i.avail_in===0&&Qe(F)<=Qe(A)&&F!==v)return xe(i,U);if(b.status===re&&i.avail_in!==0)return xe(i,U);if(b.status===oe&&b.wrap===0&&(b.status=Ie),b.status===oe){let B=X+(b.w_bits-8<<4)<<8,W=-1;if(b.strategy>=E||b.level<2?W=0:b.level<6?W=1:b.level===6?W=2:W=3,B|=W<<6,b.strstart!==0&&(B|=Ne),B+=31-B%31,De(b,B),b.strstart!==0&&(De(b,i.adler>>>16),De(b,i.adler&65535)),i.adler=1,b.status=Ie,ge(i),b.pending!==0)return b.last_flush=-1,m}if(b.status===ie){if(i.adler=0,ne(b,31),ne(b,139),ne(b,8),b.gzhead)ne(b,(b.gzhead.text?1:0)+(b.gzhead.hcrc?2:0)+(b.gzhead.extra?4:0)+(b.gzhead.name?8:0)+(b.gzhead.comment?16:0)),ne(b,b.gzhead.time&255),ne(b,b.gzhead.time>>8&255),ne(b,b.gzhead.time>>16&255),ne(b,b.gzhead.time>>24&255),ne(b,b.level===9?2:b.strategy>=E||b.level<2?4:0),ne(b,b.gzhead.os&255),b.gzhead.extra&&b.gzhead.extra.length&&(ne(b,b.gzhead.extra.length&255),ne(b,b.gzhead.extra.length>>8&255)),b.gzhead.hcrc&&(i.adler=d(i.adler,b.pending_buf,b.pending,0)),b.gzindex=0,b.status=he;else if(ne(b,0),ne(b,0),ne(b,0),ne(b,0),ne(b,0),ne(b,b.level===9?2:b.strategy>=E||b.level<2?4:0),ne(b,$e),b.status=Ie,ge(i),b.pending!==0)return b.last_flush=-1,m}if(b.status===he){if(b.gzhead.extra){let B=b.pending,W=(b.gzhead.extra.length&65535)-b.gzindex;for(;b.pending+W>b.pending_buf_size;){let Y=b.pending_buf_size-b.pending;if(b.pending_buf.set(b.gzhead.extra.subarray(b.gzindex,b.gzindex+Y),b.pending),b.pending=b.pending_buf_size,b.gzhead.hcrc&&b.pending>B&&(i.adler=d(i.adler,b.pending_buf,b.pending-B,B)),b.gzindex+=Y,ge(i),b.pending!==0)return b.last_flush=-1,m;B=0,W-=Y}let ee=new Uint8Array(b.gzhead.extra);b.pending_buf.set(ee.subarray(b.gzindex,b.gzindex+W),b.pending),b.pending+=W,b.gzhead.hcrc&&b.pending>B&&(i.adler=d(i.adler,b.pending_buf,b.pending-B,B)),b.gzindex=0}b.status=Ge}if(b.status===Ge){if(b.gzhead.name){let B=b.pending,W;do{if(b.pending===b.pending_buf_size){if(b.gzhead.hcrc&&b.pending>B&&(i.adler=d(i.adler,b.pending_buf,b.pending-B,B)),ge(i),b.pending!==0)return b.last_flush=-1,m;B=0}b.gzindex<b.gzhead.name.length?W=b.gzhead.name.charCodeAt(b.gzindex++)&255:W=0,ne(b,W)}while(W!==0);b.gzhead.hcrc&&b.pending>B&&(i.adler=d(i.adler,b.pending_buf,b.pending-B,B)),b.gzindex=0}b.status=Ve}if(b.status===Ve){if(b.gzhead.comment){let B=b.pending,W;do{if(b.pending===b.pending_buf_size){if(b.gzhead.hcrc&&b.pending>B&&(i.adler=d(i.adler,b.pending_buf,b.pending-B,B)),ge(i),b.pending!==0)return b.last_flush=-1,m;B=0}b.gzindex<b.gzhead.comment.length?W=b.gzhead.comment.charCodeAt(b.gzindex++)&255:W=0,ne(b,W)}while(W!==0);b.gzhead.hcrc&&b.pending>B&&(i.adler=d(i.adler,b.pending_buf,b.pending-B,B))}b.status=je}if(b.status===je){if(b.gzhead.hcrc){if(b.pending+2>b.pending_buf_size&&(ge(i),b.pending!==0))return b.last_flush=-1,m;ne(b,i.adler&255),ne(b,i.adler>>8&255),i.adler=0}if(b.status=Ie,ge(i),b.pending!==0)return b.last_flush=-1,m}if(i.avail_in!==0||b.lookahead!==0||F!==k&&b.status!==re){let B=b.level===0?s(b,F):b.strategy===E?x(b,F):b.strategy===S?_(b,F):y[b.level].func(b,F);if((B===Ue||B===Be)&&(b.status=re),B===de||B===Ue)return i.avail_out===0&&(b.last_flush=-1),m;if(B===Ae&&(F===g?u(b):F!==I&&(t(b,0,0,!1),F===f&&(Te(b.head),b.lookahead===0&&(b.strstart=0,b.block_start=0,b.insert=0))),ge(i),i.avail_out===0))return b.last_flush=-1,m}return F!==v?m:b.wrap<=0?D:(b.wrap===2?(ne(b,i.adler&255),ne(b,i.adler>>8&255),ne(b,i.adler>>16&255),ne(b,i.adler>>24&255),ne(b,i.total_in&255),ne(b,i.total_in>>8&255),ne(b,i.total_in>>16&255),ne(b,i.total_in>>24&255)):(De(b,i.adler>>>16),De(b,i.adler&65535)),ge(i),b.wrap>0&&(b.wrap=-b.wrap),b.pending!==0?m:D)},pt=i=>{if(K(i))return R;const F=i.state.status;return i.state=null,F===Ie?xe(i,T):m},pe=(i,F)=>{let b=F.length;if(K(i))return R;const A=i.state,B=A.wrap;if(B===2||B===1&&A.status!==oe||A.lookahead)return R;if(B===1&&(i.adler=o(i.adler,F,b,0)),A.wrap=0,b>=A.w_size){B===0&&(Te(A.head),A.strstart=0,A.block_start=0,A.insert=0);let Fe=new Uint8Array(A.w_size);Fe.set(F.subarray(b-A.w_size,b),0),F=Fe,b=A.w_size}const W=i.avail_in,ee=i.next_in,Y=i.input;for(i.avail_in=b,i.next_in=0,i.input=F,w(A);A.lookahead>=te;){let Fe=A.strstart,ae=A.lookahead-(te-1);do A.ins_h=Se(A,A.ins_h,A.window[Fe+te-1]),A.prev[Fe&A.w_mask]=A.head[A.ins_h],A.head[A.ins_h]=Fe,Fe++;while(--ae);A.strstart=Fe,A.lookahead=te-1,w(A)}return A.strstart+=A.lookahead,A.block_start=A.strstart,A.insert=A.lookahead,A.lookahead=0,A.match_length=A.prev_length=te-1,A.match_available=0,i.next_in=ee,i.input=Y,i.avail_in=W,A.wrap=B,m};return We.deflateInit=M,We.deflateInit2=ce,We.deflateReset=Q,We.deflateResetKeep=P,We.deflateSetHeader=j,We.deflate=z,We.deflateEnd=pt,We.deflateSetDictionary=pe,We.deflateInfo="pako deflate (from Nodeca project)",We}var Dt={},gi;function bi(){if(gi)return Dt;gi=1;const l=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);return Dt.assign=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const a=e.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(const u in a)l(a,u)&&(t[u]=a[u])}}return t},Dt.flattenChunks=t=>{let e=0;for(let u=0,o=t.length;u<o;u++)e+=t[u].length;const a=new Uint8Array(e);for(let u=0,o=0,d=t.length;u<d;u++){let h=t[u];a.set(h,o),o+=h.length}return a},Dt}var kt={},mi;function xi(){if(mi)return kt;mi=1;let l=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}const t=new Uint8Array(256);for(let a=0;a<256;a++)t[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;t[254]=t[254]=1,kt.string2buf=a=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(a);let u,o,d,h,k,g=a.length,f=0;for(h=0;h<g;h++)o=a.charCodeAt(h),(o&64512)===55296&&h+1<g&&(d=a.charCodeAt(h+1),(d&64512)===56320&&(o=65536+(o-55296<<10)+(d-56320),h++)),f+=o<128?1:o<2048?2:o<65536?3:4;for(u=new Uint8Array(f),k=0,h=0;k<f;h++)o=a.charCodeAt(h),(o&64512)===55296&&h+1<g&&(d=a.charCodeAt(h+1),(d&64512)===56320&&(o=65536+(o-55296<<10)+(d-56320),h++)),o<128?u[k++]=o:o<2048?(u[k++]=192|o>>>6,u[k++]=128|o&63):o<65536?(u[k++]=224|o>>>12,u[k++]=128|o>>>6&63,u[k++]=128|o&63):(u[k++]=240|o>>>18,u[k++]=128|o>>>12&63,u[k++]=128|o>>>6&63,u[k++]=128|o&63);return u};const e=(a,u)=>{if(u<65534&&a.subarray&&l)return String.fromCharCode.apply(null,a.length===u?a:a.subarray(0,u));let o="";for(let d=0;d<u;d++)o+=String.fromCharCode(a[d]);return o};return kt.buf2string=(a,u)=>{const o=u||a.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(a.subarray(0,u));let d,h;const k=new Array(o*2);for(h=0,d=0;d<o;){let g=a[d++];if(g<128){k[h++]=g;continue}let f=t[g];if(f>4){k[h++]=65533,d+=f-1;continue}for(g&=f===2?31:f===3?15:7;f>1&&d<o;)g=g<<6|a[d++]&63,f--;if(f>1){k[h++]=65533;continue}g<65536?k[h++]=g:(g-=65536,k[h++]=55296|g>>10&1023,k[h++]=56320|g&1023)}return e(k,h)},kt.utf8border=(a,u)=>{u=u||a.length,u>a.length&&(u=a.length);let o=u-1;for(;o>=0&&(a[o]&192)===128;)o--;return o<0||o===0?u:o+t[a[o]]>u?o:u},kt}var rn,yi;function Ei(){if(yi)return rn;yi=1;function l(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return rn=l,rn}var ki;function fo(){if(ki)return ot;ki=1;const l=so(),t=bi(),e=xi(),a=tn(),u=Ei(),o=Object.prototype.toString,{Z_NO_FLUSH:d,Z_SYNC_FLUSH:h,Z_FULL_FLUSH:k,Z_FINISH:g,Z_OK:f,Z_STREAM_END:v,Z_DEFAULT_COMPRESSION:I,Z_DEFAULT_STRATEGY:m,Z_DEFLATED:D}=st();function R(N){this.options=t.assign({level:I,method:D,chunkSize:16384,windowBits:15,memLevel:8,strategy:m},N||{});let E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;let S=l.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(S!==f)throw new Error(a[S]);if(E.header&&l.deflateSetHeader(this.strm,E.header),E.dictionary){let O;if(typeof E.dictionary=="string"?O=e.string2buf(E.dictionary):o.call(E.dictionary)==="[object ArrayBuffer]"?O=new Uint8Array(E.dictionary):O=E.dictionary,S=l.deflateSetDictionary(this.strm,O),S!==f)throw new Error(a[S]);this._dict_set=!0}}R.prototype.push=function(N,E){const S=this.strm,O=this.options.chunkSize;let C,$;if(this.ended)return!1;for(E===~~E?$=E:$=E===!0?g:d,typeof N=="string"?S.input=e.string2buf(N):o.call(N)==="[object ArrayBuffer]"?S.input=new Uint8Array(N):S.input=N,S.next_in=0,S.avail_in=S.input.length;;){if(S.avail_out===0&&(S.output=new Uint8Array(O),S.next_out=0,S.avail_out=O),($===h||$===k)&&S.avail_out<=6){this.onData(S.output.subarray(0,S.next_out)),S.avail_out=0;continue}if(C=l.deflate(S,$),C===v)return S.next_out>0&&this.onData(S.output.subarray(0,S.next_out)),C=l.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===f;if(S.avail_out===0){this.onData(S.output);continue}if($>0&&S.next_out>0){this.onData(S.output.subarray(0,S.next_out)),S.avail_out=0;continue}if(S.avail_in===0)break}return!0},R.prototype.onData=function(N){this.chunks.push(N)},R.prototype.onEnd=function(N){N===f&&(this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg};function T(N,E){const S=new R(E);if(S.push(N,!0),S.err)throw S.msg||a[S.err];return S.result}function U(N,E){return E=E||{},E.raw=!0,T(N,E)}function Z(N,E){return E=E||{},E.gzip=!0,T(N,E)}return ot.Deflate=R,ot.deflate=T,ot.deflateRaw=U,ot.gzip=Z,ot.constants=st(),ot}var ft={},Ze={},on,vi;function lo(){if(vi)return on;vi=1;const l=16209,t=16191;return on=function(a,u){let o,d,h,k,g,f,v,I,m,D,R,T,U,Z,N,E,S,O,C,$,X,V,H,q;const J=a.state;o=a.next_in,H=a.input,d=o+(a.avail_in-5),h=a.next_out,q=a.output,k=h-(u-a.avail_out),g=h+(a.avail_out-257),f=J.dmax,v=J.wsize,I=J.whave,m=J.wnext,D=J.window,R=J.hold,T=J.bits,U=J.lencode,Z=J.distcode,N=(1<<J.lenbits)-1,E=(1<<J.distbits)-1;e:do{T<15&&(R+=H[o++]<<T,T+=8,R+=H[o++]<<T,T+=8),S=U[R&N];t:for(;;){if(O=S>>>24,R>>>=O,T-=O,O=S>>>16&255,O===0)q[h++]=S&65535;else if(O&16){C=S&65535,O&=15,O&&(T<O&&(R+=H[o++]<<T,T+=8),C+=R&(1<<O)-1,R>>>=O,T-=O),T<15&&(R+=H[o++]<<T,T+=8,R+=H[o++]<<T,T+=8),S=Z[R&E];n:for(;;){if(O=S>>>24,R>>>=O,T-=O,O=S>>>16&255,O&16){if($=S&65535,O&=15,T<O&&(R+=H[o++]<<T,T+=8,T<O&&(R+=H[o++]<<T,T+=8)),$+=R&(1<<O)-1,$>f){a.msg="invalid distance too far back",J.mode=l;break e}if(R>>>=O,T-=O,O=h-k,$>O){if(O=$-O,O>I&&J.sane){a.msg="invalid distance too far back",J.mode=l;break e}if(X=0,V=D,m===0){if(X+=v-O,O<C){C-=O;do q[h++]=D[X++];while(--O);X=h-$,V=q}}else if(m<O){if(X+=v+m-O,O-=m,O<C){C-=O;do q[h++]=D[X++];while(--O);if(X=0,m<C){O=m,C-=O;do q[h++]=D[X++];while(--O);X=h-$,V=q}}}else if(X+=m-O,O<C){C-=O;do q[h++]=D[X++];while(--O);X=h-$,V=q}for(;C>2;)q[h++]=V[X++],q[h++]=V[X++],q[h++]=V[X++],C-=3;C&&(q[h++]=V[X++],C>1&&(q[h++]=V[X++]))}else{X=h-$;do q[h++]=q[X++],q[h++]=q[X++],q[h++]=q[X++],C-=3;while(C>2);C&&(q[h++]=q[X++],C>1&&(q[h++]=q[X++]))}}else if((O&64)===0){S=Z[(S&65535)+(R&(1<<O)-1)];continue n}else{a.msg="invalid distance code",J.mode=l;break e}break}}else if((O&64)===0){S=U[(S&65535)+(R&(1<<O)-1)];continue t}else if(O&32){J.mode=t;break e}else{a.msg="invalid literal/length code",J.mode=l;break e}break}}while(o<d&&h<g);C=T>>3,o-=C,T-=C<<3,R&=(1<<T)-1,a.next_in=o,a.next_out=h,a.avail_in=o<d?5+(d-o):5-(o-d),a.avail_out=h<g?257+(g-h):257-(h-g),J.hold=R,J.bits=T},on}var an,Ii;function co(){if(Ii)return an;Ii=1;const l=15,t=852,e=592,a=0,u=1,o=2,d=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),h=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),k=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),g=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);return an=(v,I,m,D,R,T,U,Z)=>{const N=Z.bits;let E=0,S=0,O=0,C=0,$=0,X=0,V=0,H=0,q=0,J=0,se,ue,ke,ve,ye,Ce=null,te;const fe=new Uint16Array(l+1),le=new Uint16Array(l+1);let Ne=null,oe,ie,he;for(E=0;E<=l;E++)fe[E]=0;for(S=0;S<D;S++)fe[I[m+S]]++;for($=N,C=l;C>=1&&fe[C]===0;C--);if($>C&&($=C),C===0)return R[T++]=1<<24|64<<16|0,R[T++]=1<<24|64<<16|0,Z.bits=1,0;for(O=1;O<C&&fe[O]===0;O++);for($<O&&($=O),H=1,E=1;E<=l;E++)if(H<<=1,H-=fe[E],H<0)return-1;if(H>0&&(v===a||C!==1))return-1;for(le[1]=0,E=1;E<l;E++)le[E+1]=le[E]+fe[E];for(S=0;S<D;S++)I[m+S]!==0&&(U[le[I[m+S]]++]=S);if(v===a?(Ce=Ne=U,te=20):v===u?(Ce=d,Ne=h,te=257):(Ce=k,Ne=g,te=0),J=0,S=0,E=O,ye=T,X=$,V=0,ke=-1,q=1<<$,ve=q-1,v===u&&q>t||v===o&&q>e)return 1;for(;;){oe=E-V,U[S]+1<te?(ie=0,he=U[S]):U[S]>=te?(ie=Ne[U[S]-te],he=Ce[U[S]-te]):(ie=96,he=0),se=1<<E-V,ue=1<<X,O=ue;do ue-=se,R[ye+(J>>V)+ue]=oe<<24|ie<<16|he|0;while(ue!==0);for(se=1<<E-1;J&se;)se>>=1;if(se!==0?(J&=se-1,J+=se):J=0,S++,--fe[E]===0){if(E===C)break;E=I[m+U[S]]}if(E>$&&(J&ve)!==ke){for(V===0&&(V=$),ye+=O,X=E-V,H=1<<X;X+V<C&&(H-=fe[X+V],!(H<=0));)X++,H<<=1;if(q+=1<<X,v===u&&q>t||v===o&&q>e)return 1;ke=J&ve,R[ke]=$<<24|X<<16|ye-T|0}}return J!==0&&(R[ye+J]=E-V<<24|64<<16|0),Z.bits=$,0},an}var Ai;function uo(){if(Ai)return Ze;Ai=1;const l=ui(),t=di(),e=lo(),a=co(),u=0,o=1,d=2,{Z_FINISH:h,Z_BLOCK:k,Z_TREES:g,Z_OK:f,Z_STREAM_END:v,Z_NEED_DICT:I,Z_STREAM_ERROR:m,Z_DATA_ERROR:D,Z_MEM_ERROR:R,Z_BUF_ERROR:T,Z_DEFLATED:U}=st(),Z=16180,N=16181,E=16182,S=16183,O=16184,C=16185,$=16186,X=16187,V=16188,H=16189,q=16190,J=16191,se=16192,ue=16193,ke=16194,ve=16195,ye=16196,Ce=16197,te=16198,fe=16199,le=16200,Ne=16201,oe=16202,ie=16203,he=16204,Ge=16205,Ve=16206,je=16207,Ie=16208,re=16209,de=16210,Ae=16211,Ue=852,Be=592,xe=15,Qe=p=>(p>>>24&255)+(p>>>8&65280)+((p&65280)<<8)+((p&255)<<24);function Te(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Re=p=>{if(!p)return 1;const y=p.state;return!y||y.strm!==p||y.mode<Z||y.mode>Ae?1:0},lt=p=>{if(Re(p))return m;const y=p.state;return p.total_in=p.total_out=y.total=0,p.msg="",y.wrap&&(p.adler=y.wrap&1),y.mode=Z,y.last=0,y.havedict=0,y.flags=-1,y.dmax=32768,y.head=null,y.hold=0,y.bits=0,y.lencode=y.lendyn=new Int32Array(Ue),y.distcode=y.distdyn=new Int32Array(Be),y.sane=1,y.back=-1,f},Se=p=>{if(Re(p))return m;const y=p.state;return y.wsize=0,y.whave=0,y.wnext=0,lt(p)},ge=(p,y)=>{let c;if(Re(p))return m;const L=p.state;return y<0?(c=0,y=-y):(c=(y>>4)+5,y<48&&(y&=15)),y&&(y<8||y>15)?m:(L.window!==null&&L.wbits!==y&&(L.window=null),L.wrap=c,L.wbits=y,Se(p))},we=(p,y)=>{if(!p)return m;const c=new Te;p.state=c,c.strm=p,c.window=null,c.mode=Z;const L=ge(p,y);return L!==f&&(p.state=null),L},ne=p=>we(p,xe);let De=!0,qe,Ee;const w=p=>{if(De){qe=new Int32Array(512),Ee=new Int32Array(32);let y=0;for(;y<144;)p.lens[y++]=8;for(;y<256;)p.lens[y++]=9;for(;y<280;)p.lens[y++]=7;for(;y<288;)p.lens[y++]=8;for(a(o,p.lens,0,288,qe,0,p.work,{bits:9}),y=0;y<32;)p.lens[y++]=5;a(d,p.lens,0,32,Ee,0,p.work,{bits:5}),De=!1}p.lencode=qe,p.lenbits=9,p.distcode=Ee,p.distbits=5},s=(p,y,c,L)=>{let K;const P=p.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new Uint8Array(P.wsize)),L>=P.wsize?(P.window.set(y.subarray(c-P.wsize,c),0),P.wnext=0,P.whave=P.wsize):(K=P.wsize-P.wnext,K>L&&(K=L),P.window.set(y.subarray(c-L,c-L+K),P.wnext),L-=K,L?(P.window.set(y.subarray(c-L,c),0),P.wnext=L,P.whave=P.wsize):(P.wnext+=K,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=K))),0},n=(p,y)=>{let c,L,K,P,Q,j,ce,M,z,pt,pe,i,F,b,A=0,B,W,ee,Y,Fe,ae,be,Me;const me=new Uint8Array(4);let Xe,ze;const Mi=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Re(p)||!p.output||!p.input&&p.avail_in!==0)return m;c=p.state,c.mode===J&&(c.mode=se),Q=p.next_out,K=p.output,ce=p.avail_out,P=p.next_in,L=p.input,j=p.avail_in,M=c.hold,z=c.bits,pt=j,pe=ce,Me=f;e:for(;;)switch(c.mode){case Z:if(c.wrap===0){c.mode=se;break}for(;z<16;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(c.wrap&2&&M===35615){c.wbits===0&&(c.wbits=15),c.check=0,me[0]=M&255,me[1]=M>>>8&255,c.check=t(c.check,me,2,0),M=0,z=0,c.mode=N;break}if(c.head&&(c.head.done=!1),!(c.wrap&1)||(((M&255)<<8)+(M>>8))%31){p.msg="incorrect header check",c.mode=re;break}if((M&15)!==U){p.msg="unknown compression method",c.mode=re;break}if(M>>>=4,z-=4,be=(M&15)+8,c.wbits===0&&(c.wbits=be),be>15||be>c.wbits){p.msg="invalid window size",c.mode=re;break}c.dmax=1<<c.wbits,c.flags=0,p.adler=c.check=1,c.mode=M&512?H:J,M=0,z=0;break;case N:for(;z<16;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(c.flags=M,(c.flags&255)!==U){p.msg="unknown compression method",c.mode=re;break}if(c.flags&57344){p.msg="unknown header flags set",c.mode=re;break}c.head&&(c.head.text=M>>8&1),c.flags&512&&c.wrap&4&&(me[0]=M&255,me[1]=M>>>8&255,c.check=t(c.check,me,2,0)),M=0,z=0,c.mode=E;case E:for(;z<32;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}c.head&&(c.head.time=M),c.flags&512&&c.wrap&4&&(me[0]=M&255,me[1]=M>>>8&255,me[2]=M>>>16&255,me[3]=M>>>24&255,c.check=t(c.check,me,4,0)),M=0,z=0,c.mode=S;case S:for(;z<16;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}c.head&&(c.head.xflags=M&255,c.head.os=M>>8),c.flags&512&&c.wrap&4&&(me[0]=M&255,me[1]=M>>>8&255,c.check=t(c.check,me,2,0)),M=0,z=0,c.mode=O;case O:if(c.flags&1024){for(;z<16;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}c.length=M,c.head&&(c.head.extra_len=M),c.flags&512&&c.wrap&4&&(me[0]=M&255,me[1]=M>>>8&255,c.check=t(c.check,me,2,0)),M=0,z=0}else c.head&&(c.head.extra=null);c.mode=C;case C:if(c.flags&1024&&(i=c.length,i>j&&(i=j),i&&(c.head&&(be=c.head.extra_len-c.length,c.head.extra||(c.head.extra=new Uint8Array(c.head.extra_len)),c.head.extra.set(L.subarray(P,P+i),be)),c.flags&512&&c.wrap&4&&(c.check=t(c.check,L,i,P)),j-=i,P+=i,c.length-=i),c.length))break e;c.length=0,c.mode=$;case $:if(c.flags&2048){if(j===0)break e;i=0;do be=L[P+i++],c.head&&be&&c.length<65536&&(c.head.name+=String.fromCharCode(be));while(be&&i<j);if(c.flags&512&&c.wrap&4&&(c.check=t(c.check,L,i,P)),j-=i,P+=i,be)break e}else c.head&&(c.head.name=null);c.length=0,c.mode=X;case X:if(c.flags&4096){if(j===0)break e;i=0;do be=L[P+i++],c.head&&be&&c.length<65536&&(c.head.comment+=String.fromCharCode(be));while(be&&i<j);if(c.flags&512&&c.wrap&4&&(c.check=t(c.check,L,i,P)),j-=i,P+=i,be)break e}else c.head&&(c.head.comment=null);c.mode=V;case V:if(c.flags&512){for(;z<16;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(c.wrap&4&&M!==(c.check&65535)){p.msg="header crc mismatch",c.mode=re;break}M=0,z=0}c.head&&(c.head.hcrc=c.flags>>9&1,c.head.done=!0),p.adler=c.check=0,c.mode=J;break;case H:for(;z<32;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}p.adler=c.check=Qe(M),M=0,z=0,c.mode=q;case q:if(c.havedict===0)return p.next_out=Q,p.avail_out=ce,p.next_in=P,p.avail_in=j,c.hold=M,c.bits=z,I;p.adler=c.check=1,c.mode=J;case J:if(y===k||y===g)break e;case se:if(c.last){M>>>=z&7,z-=z&7,c.mode=Ve;break}for(;z<3;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}switch(c.last=M&1,M>>>=1,z-=1,M&3){case 0:c.mode=ue;break;case 1:if(w(c),c.mode=fe,y===g){M>>>=2,z-=2;break e}break;case 2:c.mode=ye;break;case 3:p.msg="invalid block type",c.mode=re}M>>>=2,z-=2;break;case ue:for(M>>>=z&7,z-=z&7;z<32;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if((M&65535)!==(M>>>16^65535)){p.msg="invalid stored block lengths",c.mode=re;break}if(c.length=M&65535,M=0,z=0,c.mode=ke,y===g)break e;case ke:c.mode=ve;case ve:if(i=c.length,i){if(i>j&&(i=j),i>ce&&(i=ce),i===0)break e;K.set(L.subarray(P,P+i),Q),j-=i,P+=i,ce-=i,Q+=i,c.length-=i;break}c.mode=J;break;case ye:for(;z<14;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(c.nlen=(M&31)+257,M>>>=5,z-=5,c.ndist=(M&31)+1,M>>>=5,z-=5,c.ncode=(M&15)+4,M>>>=4,z-=4,c.nlen>286||c.ndist>30){p.msg="too many length or distance symbols",c.mode=re;break}c.have=0,c.mode=Ce;case Ce:for(;c.have<c.ncode;){for(;z<3;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}c.lens[Mi[c.have++]]=M&7,M>>>=3,z-=3}for(;c.have<19;)c.lens[Mi[c.have++]]=0;if(c.lencode=c.lendyn,c.lenbits=7,Xe={bits:c.lenbits},Me=a(u,c.lens,0,19,c.lencode,0,c.work,Xe),c.lenbits=Xe.bits,Me){p.msg="invalid code lengths set",c.mode=re;break}c.have=0,c.mode=te;case te:for(;c.have<c.nlen+c.ndist;){for(;A=c.lencode[M&(1<<c.lenbits)-1],B=A>>>24,W=A>>>16&255,ee=A&65535,!(B<=z);){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(ee<16)M>>>=B,z-=B,c.lens[c.have++]=ee;else{if(ee===16){for(ze=B+2;z<ze;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(M>>>=B,z-=B,c.have===0){p.msg="invalid bit length repeat",c.mode=re;break}be=c.lens[c.have-1],i=3+(M&3),M>>>=2,z-=2}else if(ee===17){for(ze=B+3;z<ze;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}M>>>=B,z-=B,be=0,i=3+(M&7),M>>>=3,z-=3}else{for(ze=B+7;z<ze;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}M>>>=B,z-=B,be=0,i=11+(M&127),M>>>=7,z-=7}if(c.have+i>c.nlen+c.ndist){p.msg="invalid bit length repeat",c.mode=re;break}for(;i--;)c.lens[c.have++]=be}}if(c.mode===re)break;if(c.lens[256]===0){p.msg="invalid code -- missing end-of-block",c.mode=re;break}if(c.lenbits=9,Xe={bits:c.lenbits},Me=a(o,c.lens,0,c.nlen,c.lencode,0,c.work,Xe),c.lenbits=Xe.bits,Me){p.msg="invalid literal/lengths set",c.mode=re;break}if(c.distbits=6,c.distcode=c.distdyn,Xe={bits:c.distbits},Me=a(d,c.lens,c.nlen,c.ndist,c.distcode,0,c.work,Xe),c.distbits=Xe.bits,Me){p.msg="invalid distances set",c.mode=re;break}if(c.mode=fe,y===g)break e;case fe:c.mode=le;case le:if(j>=6&&ce>=258){p.next_out=Q,p.avail_out=ce,p.next_in=P,p.avail_in=j,c.hold=M,c.bits=z,e(p,pe),Q=p.next_out,K=p.output,ce=p.avail_out,P=p.next_in,L=p.input,j=p.avail_in,M=c.hold,z=c.bits,c.mode===J&&(c.back=-1);break}for(c.back=0;A=c.lencode[M&(1<<c.lenbits)-1],B=A>>>24,W=A>>>16&255,ee=A&65535,!(B<=z);){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(W&&(W&240)===0){for(Y=B,Fe=W,ae=ee;A=c.lencode[ae+((M&(1<<Y+Fe)-1)>>Y)],B=A>>>24,W=A>>>16&255,ee=A&65535,!(Y+B<=z);){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}M>>>=Y,z-=Y,c.back+=Y}if(M>>>=B,z-=B,c.back+=B,c.length=ee,W===0){c.mode=Ge;break}if(W&32){c.back=-1,c.mode=J;break}if(W&64){p.msg="invalid literal/length code",c.mode=re;break}c.extra=W&15,c.mode=Ne;case Ne:if(c.extra){for(ze=c.extra;z<ze;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}c.length+=M&(1<<c.extra)-1,M>>>=c.extra,z-=c.extra,c.back+=c.extra}c.was=c.length,c.mode=oe;case oe:for(;A=c.distcode[M&(1<<c.distbits)-1],B=A>>>24,W=A>>>16&255,ee=A&65535,!(B<=z);){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if((W&240)===0){for(Y=B,Fe=W,ae=ee;A=c.distcode[ae+((M&(1<<Y+Fe)-1)>>Y)],B=A>>>24,W=A>>>16&255,ee=A&65535,!(Y+B<=z);){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}M>>>=Y,z-=Y,c.back+=Y}if(M>>>=B,z-=B,c.back+=B,W&64){p.msg="invalid distance code",c.mode=re;break}c.offset=ee,c.extra=W&15,c.mode=ie;case ie:if(c.extra){for(ze=c.extra;z<ze;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}c.offset+=M&(1<<c.extra)-1,M>>>=c.extra,z-=c.extra,c.back+=c.extra}if(c.offset>c.dmax){p.msg="invalid distance too far back",c.mode=re;break}c.mode=he;case he:if(ce===0)break e;if(i=pe-ce,c.offset>i){if(i=c.offset-i,i>c.whave&&c.sane){p.msg="invalid distance too far back",c.mode=re;break}i>c.wnext?(i-=c.wnext,F=c.wsize-i):F=c.wnext-i,i>c.length&&(i=c.length),b=c.window}else b=K,F=Q-c.offset,i=c.length;i>ce&&(i=ce),ce-=i,c.length-=i;do K[Q++]=b[F++];while(--i);c.length===0&&(c.mode=le);break;case Ge:if(ce===0)break e;K[Q++]=c.length,ce--,c.mode=le;break;case Ve:if(c.wrap){for(;z<32;){if(j===0)break e;j--,M|=L[P++]<<z,z+=8}if(pe-=ce,p.total_out+=pe,c.total+=pe,c.wrap&4&&pe&&(p.adler=c.check=c.flags?t(c.check,K,pe,Q-pe):l(c.check,K,pe,Q-pe)),pe=ce,c.wrap&4&&(c.flags?M:Qe(M))!==c.check){p.msg="incorrect data check",c.mode=re;break}M=0,z=0}c.mode=je;case je:if(c.wrap&&c.flags){for(;z<32;){if(j===0)break e;j--,M+=L[P++]<<z,z+=8}if(c.wrap&4&&M!==(c.total&4294967295)){p.msg="incorrect length check",c.mode=re;break}M=0,z=0}c.mode=Ie;case Ie:Me=v;break e;case re:Me=D;break e;case de:return R;case Ae:default:return m}return p.next_out=Q,p.avail_out=ce,p.next_in=P,p.avail_in=j,c.hold=M,c.bits=z,(c.wsize||pe!==p.avail_out&&c.mode<re&&(c.mode<Ve||y!==h))&&s(p,p.output,p.next_out,pe-p.avail_out),pt-=p.avail_in,pe-=p.avail_out,p.total_in+=pt,p.total_out+=pe,c.total+=pe,c.wrap&4&&pe&&(p.adler=c.check=c.flags?t(c.check,K,pe,p.next_out-pe):l(c.check,K,pe,p.next_out-pe)),p.data_type=c.bits+(c.last?64:0)+(c.mode===J?128:0)+(c.mode===fe||c.mode===ke?256:0),(pt===0&&pe===0||y===h)&&Me===f&&(Me=T),Me},r=p=>{if(Re(p))return m;let y=p.state;return y.window&&(y.window=null),p.state=null,f},_=(p,y)=>{if(Re(p))return m;const c=p.state;return(c.wrap&2)===0?m:(c.head=y,y.done=!1,f)},x=(p,y)=>{const c=y.length;let L,K,P;return Re(p)||(L=p.state,L.wrap!==0&&L.mode!==q)?m:L.mode===q&&(K=1,K=l(K,y,c,0),K!==L.check)?D:(P=s(p,y,c,c),P?(L.mode=de,R):(L.havedict=1,f))};return Ze.inflateReset=Se,Ze.inflateReset2=ge,Ze.inflateResetKeep=lt,Ze.inflateInit=ne,Ze.inflateInit2=we,Ze.inflate=n,Ze.inflateEnd=r,Ze.inflateGetHeader=_,Ze.inflateSetDictionary=x,Ze.inflateInfo="pako inflate (from Nodeca project)",Ze}var sn,Bi;function ho(){if(Bi)return sn;Bi=1;function l(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return sn=l,sn}var Ti;function po(){if(Ti)return ft;Ti=1;const l=uo(),t=bi(),e=xi(),a=tn(),u=Ei(),o=ho(),d=Object.prototype.toString,{Z_NO_FLUSH:h,Z_FINISH:k,Z_OK:g,Z_STREAM_END:f,Z_NEED_DICT:v,Z_STREAM_ERROR:I,Z_DATA_ERROR:m,Z_MEM_ERROR:D}=st();function R(Z){this.options=t.assign({chunkSize:1024*64,windowBits:15,to:""},Z||{});const N=this.options;N.raw&&N.windowBits>=0&&N.windowBits<16&&(N.windowBits=-N.windowBits,N.windowBits===0&&(N.windowBits=-15)),N.windowBits>=0&&N.windowBits<16&&!(Z&&Z.windowBits)&&(N.windowBits+=32),N.windowBits>15&&N.windowBits<48&&(N.windowBits&15)===0&&(N.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;let E=l.inflateInit2(this.strm,N.windowBits);if(E!==g)throw new Error(a[E]);if(this.header=new o,l.inflateGetHeader(this.strm,this.header),N.dictionary&&(typeof N.dictionary=="string"?N.dictionary=e.string2buf(N.dictionary):d.call(N.dictionary)==="[object ArrayBuffer]"&&(N.dictionary=new Uint8Array(N.dictionary)),N.raw&&(E=l.inflateSetDictionary(this.strm,N.dictionary),E!==g)))throw new Error(a[E])}R.prototype.push=function(Z,N){const E=this.strm,S=this.options.chunkSize,O=this.options.dictionary;let C,$,X;if(this.ended)return!1;for(N===~~N?$=N:$=N===!0?k:h,d.call(Z)==="[object ArrayBuffer]"?E.input=new Uint8Array(Z):E.input=Z,E.next_in=0,E.avail_in=E.input.length;;){for(E.avail_out===0&&(E.output=new Uint8Array(S),E.next_out=0,E.avail_out=S),C=l.inflate(E,$),C===v&&O&&(C=l.inflateSetDictionary(E,O),C===g?C=l.inflate(E,$):C===m&&(C=v));E.avail_in>0&&C===f&&E.state.wrap>0&&Z[E.next_in]!==0;)l.inflateReset(E),C=l.inflate(E,$);switch(C){case I:case m:case v:case D:return this.onEnd(C),this.ended=!0,!1}if(X=E.avail_out,E.next_out&&(E.avail_out===0||C===f))if(this.options.to==="string"){let V=e.utf8border(E.output,E.next_out),H=E.next_out-V,q=e.buf2string(E.output,V);E.next_out=H,E.avail_out=S-H,H&&E.output.set(E.output.subarray(V,V+H),0),this.onData(q)}else this.onData(E.output.length===E.next_out?E.output:E.output.subarray(0,E.next_out));if(!(C===g&&X===0)){if(C===f)return C=l.inflateEnd(this.strm),this.onEnd(C),this.ended=!0,!0;if(E.avail_in===0)break}}return!0},R.prototype.onData=function(Z){this.chunks.push(Z)},R.prototype.onEnd=function(Z){Z===g&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=Z,this.msg=this.strm.msg};function T(Z,N){const E=new R(N);if(E.push(Z),E.err)throw E.msg||a[E.err];return E.result}function U(Z,N){return N=N||{},N.raw=!0,T(Z,N)}return ft.Inflate=R,ft.inflate=T,ft.inflateRaw=U,ft.ungzip=T,ft.constants=st(),ft}var Ri;function _o(){if(Ri)return He;Ri=1;const{Deflate:l,deflate:t,deflateRaw:e,gzip:a}=fo(),{Inflate:u,inflate:o,inflateRaw:d,ungzip:h}=po(),k=st();return He.Deflate=l,He.deflate=t,He.deflateRaw=e,He.gzip=a,He.Inflate=u,He.inflate=o,He.inflateRaw=d,He.ungzip=h,He.constants=k,He}var Si;function wo(){if(Si)return yt;Si=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.parseBinary=void 0;var l=oo(),t=_o(),e=Uint8Array.from("Kaydara FBX Binary  \0\0".split(""),function(h){return h.charCodeAt(0)});function a(h){if(h.length<e.length)throw"Not a binary FBX file";var k=new l.BinaryReader(h),g=k.readUint8Array(e.length).every(function(D,R){return D===e[R]});if(!g)throw"Not a binary FBX file";for(var f=k.readUint32(),v=f>=7500,I=[];;){var m=u(k,v);if(m===null)break;I.push(m)}return I}yt.parseBinary=a;function u(h,k){var g=k?Number(h.readUint64()):h.readUint32();if(g===0)return null;var f=k?Number(h.readUint64()):h.readUint32();k?Number(h.readUint64()):h.readUint32();for(var v=h.readUint8(),I=h.readArrayAsString(v),m={name:I,props:[],nodes:[]},D=0;D<f;++D)m.props.push(o(h));for(;g-h.offset>13;){var R=u(h,k);R!==null&&m.nodes.push(R)}return h.offset=g,m}function o(h){var k=h.readUint8AsString(),g={Y:function(){return h.readInt16()},C:function(){return h.readUint8AsBool()},I:function(){return h.readInt32()},F:function(){return h.readFloat32()},D:function(){return h.readFloat64()},L:function(){return h.readInt64()},f:function(){return d(h,function(m){return m.readFloat32()})},d:function(){return d(h,function(m){return m.readFloat64()})},l:function(){return d(h,function(m){return m.readInt64()})},i:function(){return d(h,function(m){return m.readInt32()})},b:function(){return d(h,function(m){return m.readUint8AsBool()})},S:function(){return h.readArrayAsString(h.readUint32())},R:function(){return Array.from(h.readUint8Array(h.readUint32()))}};if(typeof g[k]>"u")throw"Unknown Property Type "+k.charCodeAt(0);var f=g[k](),v=function(m){return f<Number.MIN_SAFE_INTEGER||m>Number.MAX_SAFE_INTEGER?m:Number(m)};if(k==="L")f=v(f);else if(k==="l")for(var I=0;I<f.length;++I)f[I]=v(f[I]);return k==="S"&&f.indexOf("\0")!=-1&&(f=f.split("\0").reverse().join("::")),f}function d(h,k){var g=h.readUint32(),f=h.readUint32(),v=h.readUint32(),I=new l.BinaryReader(h.readUint8Array(v));f==1&&(I=new l.BinaryReader(t.inflate(I.binary)));for(var m=[],D=0;D<g;++D)m.push(k(I));return m}return yt}var vt={},Fi;function go(){if(Fi)return vt;Fi=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.parseText=void 0;function l(e){for(var a=e.split(`
`),u={name:"",props:[],nodes:[]},o=u,d=[o],h=0,k=0,g=a;k<g.length;k++){var f=g[k];if(f=f.trim(),f.length!==0&&f[0]!==";"){if(h===0)if(f[0]==="}"){if(d.length===1)throw"FBX syntax error";d.pop(),o=d[d.length-1]}else{var v=f.indexOf(":"),I=f.substring(0,v);I=I.trim();for(var m=f[f.length-1]==="{",D=f.substring(v+1,f.length-(m?1:0)),R=D.split(","),T=[],U=0,Z=R;U<Z.length;U++){var N=Z[U],E=N.trim();if(E!==""){var S=t(E);typeof S>"u"||T.push(S)}}R[R.length-1]===""&&(h=1);var O={name:I,props:T,nodes:[]};o.nodes.push(O),(m||h===1)&&(d.push(O),o=O)}else if(h===1){for(var m=f[f.length-1]==="{",D=f.substring(0,f.length-(m?1:0)),R=D.split(","),T=[],C=0,$=R;C<$.length;C++){var X=$[C],E=X.trim();if(!(E===""||E==="}")){var S=t(E);typeof S>"u"||T.push(S)}}o.props=o.props.concat(T),R[R.length-1]!==""&&(h=0),!m&&h===0&&(d.pop(),o=d[d.length-1])}}}function V(H){if(H.nodes.length===1&&H.props.length===0&&H.nodes[0].name==="a")H.props=[H.nodes[0].props],H.nodes=[];else for(var q=0,J=H.nodes;q<J.length;q++){var se=J[q];V(se)}}return V(u),u.nodes}vt.parseText=l;function t(e){if(e[0]!="*"){if(e[0]=='"')return e.substr(1,e.length-2);if(e=="T")return!0;if(e=="F")return!1;if(e=="Y")return!0;if(e=="N")return!1;if(e.indexOf(".")!=-1)return parseFloat(e);var a=BigInt(e);return a<Number.MIN_SAFE_INTEGER||a>Number.MAX_SAFE_INTEGER?a:Number(a)}}return vt}var tt={},Ci;function bo(){if(Ci)return tt;Ci=1;var l=tt&&tt.__extends||(function(){var a=function(u,o){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,h){d.__proto__=h}||function(d,h){for(var k in h)Object.prototype.hasOwnProperty.call(h,k)&&(d[k]=h[k])},a(u,o)};return function(u,o){a(u,o);function d(){this.constructor=u}u.prototype=o===null?Object.create(o):(d.prototype=o.prototype,new d)}})();Object.defineProperty(tt,"__esModule",{value:!0}),tt.FBXReader=tt.FBXReaderNode=void 0;var t=(function(){function a(u){this.fbxNode=u}return a.prototype.nodeFilter=function(u,o){var d=void 0,h=void 0;typeof u=="string"?(d=u,typeof o<"u"&&(h=o)):h=u;var k;if(typeof h<"u"){var g=function(f){for(var v in h){var I=parseInt(v);if(f.props[I]!==h[I])return!1}return!0};typeof d<"u"?k=function(f){return f.name===d&&g(f)}:k=g}else k=function(f){return f.name===d};return k},a.prototype.node=function(u,o){var d=this.fbxNode.nodes.find(this.nodeFilter(u,o));if(!(typeof d>"u"))return new a(d)},a.prototype.nodes=function(u,o){var d=this.fbxNode.nodes.filter(this.nodeFilter(u,o)).map(function(h){return new a(h)});return d},a.prototype.prop=function(u,o){var d=this.fbxNode.props[u];if(typeof o>"u")return d;if(o==="boolean")return typeof d=="boolean"?d:void 0;if(o==="number")return typeof d=="number"?d:void 0;if(o==="bigint")return typeof d=="bigint"?d:void 0;if(o==="string")return typeof d=="string"?d:void 0;if(Array.isArray(d)){if(d.length==0)return d;if(o==="boolean[]")return typeof d[0]=="boolean"?d:void 0;if(o==="number[]")return typeof d[0]=="number"?d:void 0;if(o==="bigint[]")return typeof d[0]=="bigint"?d:void 0}},a})();tt.FBXReaderNode=t;var e=(function(a){l(u,a);function u(o){var d=this,h={name:"",props:[],nodes:o};return d=a.call(this,h)||this,d.fbx=o,d}return u})(t);return tt.FBXReader=e,tt}var Ni;function mo(){return Ni||(Ni=1,(function(l){Object.defineProperty(l,"__esModule",{value:!0}),l.FBXReaderNode=l.FBXReader=l.parseText=l.parseBinary=void 0;var t=wo();Object.defineProperty(l,"parseBinary",{enumerable:!0,get:function(){return t.parseBinary}});var e=go();Object.defineProperty(l,"parseText",{enumerable:!0,get:function(){return e.parseText}});var a=bo();Object.defineProperty(l,"FBXReader",{enumerable:!0,get:function(){return a.FBXReader}}),Object.defineProperty(l,"FBXReaderNode",{enumerable:!0,get:function(){return a.FBXReaderNode}})})(Kt)),Kt}var Ui=mo();class xo{static CreateMesh(t,e,a){const u=new G.Mesh(e.prop(1,"string"),t.scene),o=a.children.find(h=>t.cachedGeometries[h.id]);if(o!==void 0){const h=t.cachedGeometries[o.id];if(h?.geometry.applyToMesh(u),h?.materialIndices?.length){let k=0,g=h.materialIndices[0];const f=u.subMeshes[0];if(u.subMeshes=[],h.materialIndices.forEach((v,I)=>{if(v!==g){const m=I-k;new G.SubMesh(g,k*3,m*3,k,m,u,u,!1,!0),g=v,k=I}}),u.subMeshes.length>0){const v=u.subMeshes[u.subMeshes.length-1],I=v.indexStart+v.indexCount;if(I!==h.materialIndices.length){const m=h.materialIndices.length-I;new G.SubMesh(g,I*3,m*3,I,m,u,u,!1,!0)}}else u.subMeshes.push(f)}}u.computeWorldMatrix(!0);const d=[];if(a.children.forEach(h=>{t.cachedMaterials[h.id]&&d.push(t.cachedMaterials[h.id])}),d.length>1){const h=new G.MultiMaterial(u.name,t.scene);d.forEach(k=>h.subMaterials.push(k)),u.material=h}else d.length>0&&(u.material=d[0]);return t.result.meshes.push(u),u}}class Oe{static GetFinalRotationQuaternion(t){const e=t.toEulerAngles();return this.GetFinalRotationQuaternionFromVector(e)}static GetFinalRotationQuaternionFromVector(t){const e=G.Quaternion.RotationAxis(G.Vector3.Left(),t.x),a=G.Quaternion.RotationAxis(G.Vector3.Up(),t.y),u=G.Quaternion.RotationAxis(G.Vector3.Forward(),t.z);return G.Quaternion.Inverse(e.multiply(a).multiply(u))}static GetMatrix(t,e){const a=G.Vector3.Zero(),u=G.Quaternion.Identity(),o=G.Vector3.Zero();t.decompose(a,u,o),o.x=-o.x;let d=Oe.GetFinalRotationQuaternion(u);if(e.preRotation&&(d=Oe.GetFinalRotationQuaternionFromVector(e.preRotation).multiply(d)),e.postRotation){const h=Oe.GetFinalRotationQuaternionFromVector(e.postRotation);d=d.multiply(G.Quaternion.Inverse(h))}return G.Matrix.Compose(a,d.normalize(),o)}}class yo{static GetConstructorName(t){let e=t&&t.constructor?t.constructor.name:"";return e===""&&(e=typeof t),e}static GetNodeMetadata(t){return t.metadata=t.metadata??{},t.metadata}static GetMeshMetadata(t){return this.GetNodeMetadata(t)}static GetTransformNodeMetadata(t){return this.GetNodeMetadata(t)}static GetMaterialMetadata(t){return t.metadata=t.metadata??{},t.metadata}static GetSourcePath(t,e){const a=un(e),u=e.lastIndexOf(a);if(u===-1)return"";const o=Bt(`${e.substr(0,u)}.js`);return At(t,"build",o)}static RandomId(){return G.Tools.RandomId()}static getAllSceneNodes(t){return t.meshes.concat(t.lights).concat(t.cameras).concat(t.transformNodes)}static IsElementChildOf(t,e){for(;t.parentElement;){if(t===e)return!0;t=t.parentElement}return!1}static Wait(t){return new Promise(e=>setTimeout(()=>e(),t))}static WaitNextAnimationFrame(){return new Promise(t=>requestAnimationFrame(()=>t()))}static Distinct(t){const e=(a,u,o)=>o.indexOf(a)===u;return t.filter(e)}static SortAlphabetically(t,e){return t.sort((a,u)=>(a=e?a[e]:a,u=e?u[e]:u,a=a.toUpperCase(),u=u.toUpperCase(),a<u?-1:a>u?1:0)),t}static CloneObject(t){return t&&JSON.parse(JSON.stringify(t))}static GetProperty(t,e){const a=e.split(".");for(let u=0;u<a.length;u++)t=t[a[u]];return t}static GetEffectiveProperty(t,e){const a=e.split(".");for(let u=0;u<a.length-1;u++)t=t[a[u]];return t}static GetEditorPreferences(){return JSON.parse(localStorage.getItem("babylonjs-editor-preferences")??"{ }")}static async CreateScreenshot(t,e){return G.Tools.CreateScreenshotAsync(t,e,{width:3840,height:2160},"image/png")}static async ShowNativeOpenFileDialog(){return(await this._ShowOpenFileDialog(!1))[0]}static async ShowNativeOpenMultipleFileDialog(){return this._ShowOpenFileDialog(!0)}static async _ShowOpenFileDialog(t){return new Promise((e,a)=>{const u=document.createElement("input");u.type="file",u.multiple=t,u.addEventListener("change",()=>{if(u.remove(),u.files?.length){const o=[];for(let d=0;d<u.files.length;d++)o.push(u.files.item(d));return e(o)}a("User decided to not choose any files.")}),u.click()})}static GetExtensionFromMimeType(t){switch(t.toLowerCase()){case"image/png":return".png";case"image/jpg":return".jpg";case"image/jpeg":return".jpeg";case"image/bmp":return".bmp";default:return".png"}}static ReadFileAsArrayBuffer(t){return new Promise((e,a)=>{G.Tools.ReadFile(t,u=>e(u),void 0,!0,u=>a(u))})}static async LoadFile(t,e,a){return new Promise((u,o)=>{G.Tools.LoadFile(t,d=>u(d),a,void 0,e,(d,h)=>o(h))})}}class Eo{static ParseGeometries(t){for(const e of t.geometries){const a=e.prop(0,"number"),u=t.connections.get(a),o=u?.parents.map(k=>t.objects.nodes("Model").find(g=>g.prop(0,"number")===k.id))[0],d=u?.children.reduce((k,g)=>(t.cachedSkeletons[g.id]!==void 0&&(k=t.cachedSkeletons[g.id]),k),void 0);let h=t.cachedGeometries[a];h||(h=this.Import(e,t.scene,d,o),t.result.geometries.push(h.geometry),t.cachedGeometries[a]=h)}}static Import(t,e,a,u){const o=t.node("Vertices")?.prop(0,"number[]");if(!o)throw new Error("Failed to parse positions of geometry");const d=t.node("PolygonVertexIndex")?.prop(0,"number[]");if(!d)throw new Error("Failed to parse indices of geometry");const h=this._ParseUvs(t.node("LayerElementUV")),k=this._ParseNormals(t.node("LayerElementNormal")),g=this._ParseMaterials(t.node("LayerElementMaterial")),f={};a&&a.rawBones.forEach((m,D)=>{m.indices.forEach((R,T)=>{f[R]||(f[R]=[]),f[R].push({id:D,weight:m.weights[T]})})});const v=this._GenerateBuffers({positions:o,indices:d,normals:k,uvs:h,materials:g,skeleton:a,weightTable:f}),I=new G.VertexData;if(I.indices=v.indices,I.positions=v.positions,v.uvs.length&&(I.uvs=v.uvs),v.normals.length&&(I.normals=v.normals),v.matricesIndices.length&&(I.matricesIndices=v.matricesIndices),v.matricesWeights.length&&(I.matricesWeights=v.matricesWeights),a&&I.matricesIndices&&I.matricesWeights&&(this._CleanWeights(a,I.matricesIndices,I.matricesWeights),this._NormalizeWeights(I.matricesWeights),this._NormalizeWeights(I.matricesWeightsExtra)),u){const m=u.node("Properties70")?.nodes("P")??[];let D=G.Vector3.One(),R=G.Vector3.Zero(),T=G.Vector3.Zero(),U="ZYX";const Z=m.find(C=>C.prop(0,"string")==="RotationOrder");Z&&(U=Z.prop(4,"string")??U);const N=m.find(C=>C.prop(0,"string")==="GeometricTranslation");N&&T.set(N.prop(4,"number")??0,N.prop(5,"number")??0,N.prop(6,"number")??0);const E=m.find(C=>C.prop(0,"string")==="GeometricRotation");E&&R.set(E.prop(4,"number")??0,E.prop(5,"number")??0,E.prop(6,"number")??0);const S=m.find(C=>C.prop(0,"string")==="GeometricScaling");S&&D.set(S.prop(4,"number")??1,S.prop(5,"number")??1,S.prop(6,"number")??1);const O=G.Matrix.Compose(D,Oe.GetFinalRotationQuaternionFromVector(R),T);O.isIdentity()||I.transform(O)}return{materialIndices:v.materialIndices,geometry:new G.Geometry(yo.RandomId(),e,I,!1)}}static _NormalizeWeights(t){if(!t)return;const e=G.Vector4.Zero();for(let a=0,u=t.length;a<u;a++){e.x=t[a],e.y=t[a+1],e.z=t[a+2],e.w=t[a+3];const o=1/e.length();o!==1/0?e.multiplyByFloats(o,o,o,o):e.set(1,0,0,0),t[a]=e.x,t[a+1]=e.y,t[a+2]=e.z,t[a+3]=e.w}}static _CleanWeights(t,e,a){const o=t.rawBones.length;let d=4,h=a.length;for(var k=0;k<h;k+=4){let f=0,v=-1;for(var g=0;g<4;g++){let I=a[k+g];f+=I,I<.001&&v<0&&(v=g)}if((v<0||v>d-1)&&(v=d-1),f>.001){let I=1/f;for(var g=0;g<4;g++)a[k+g]*=I}else v<4&&(a[k+v]=1-f,e[k+v]=o)}}static _GenerateBuffers(t){const e={};let a=0,u=0,o=[],d=[],h=[],k=[],g=[],f=0;t.indices.forEach((I,m)=>{let D=!1;I<0&&(I=I^-1,D=!0);let R=[],T=[];if(g.push(I*3,I*3+1,I*3+2),t.normals){const U=this._GetData(m,u,I,t.normals);h.push(U[0],U[1],U[2])}if(t.uvs){const U=this._GetData(m,u,I,t.uvs);o.push(U[0],U[1])}if(t.materials&&(f=Math.max(0,this._GetData(m,u,I,t.materials)[0]??0)),t.skeleton){if(t.weightTable[I]!==void 0&&t.weightTable[I].forEach(U=>{R.push(U.weight),T.push(U.id)}),R.length>4){const U=[0,0,0,0],Z=[0,0,0,0];R.forEach(function(N,E){let S=N,O=T[E];Z.forEach((C,$,X)=>{if(S>C){X[$]=S,S=C;const V=U[$];U[$]=O,O=V}})}),R=Z,T=U}for(;R.length<4;)R.push(0),T.push(0);for(let U=0;U<4;++U)d.push(R[U]),k.push(T[U])}a++,D&&(e[f]||(e[f]={uvs:[],indices:[],normals:[],positions:[],materialIndices:[],matricesIndices:[],matricesWeights:[]}),this._GenerateFace({sourceBuffers:t,outputBuffers:e[f],facePositionIndexes:g,faceLength:a,faceUVs:o,faceNormals:h,faceWeights:d,faceWeightIndices:k,materialIndex:f}),u++,a=0,o=[],h=[],d=[],k=[],g=[])});const v={uvs:[],indices:[],normals:[],positions:[],materialIndices:[],matricesIndices:[],matricesWeights:[]};for(const I in e){const m=e[I],D=v.indices.length,R=D+m.indices.length;for(let T=D;T<R;T++)v.indices.push(T);v.uvs=v.uvs.concat(m.uvs),v.normals=v.normals.concat(m.normals),v.positions=v.positions.concat(m.positions),v.materialIndices=v.materialIndices.concat(m.materialIndices),v.matricesIndices=v.matricesIndices.concat(m.matricesIndices),v.matricesWeights=v.matricesWeights.concat(m.matricesWeights)}return v}static _GenerateFace(t){for(var e=2;e<t.faceLength;e++){t.outputBuffers.positions.push(-t.sourceBuffers.positions[t.facePositionIndexes[0]]),t.outputBuffers.positions.push(t.sourceBuffers.positions[t.facePositionIndexes[1]]),t.outputBuffers.positions.push(t.sourceBuffers.positions[t.facePositionIndexes[2]]),t.outputBuffers.positions.push(-t.sourceBuffers.positions[t.facePositionIndexes[(e-1)*3]]),t.outputBuffers.positions.push(t.sourceBuffers.positions[t.facePositionIndexes[(e-1)*3+1]]),t.outputBuffers.positions.push(t.sourceBuffers.positions[t.facePositionIndexes[(e-1)*3+2]]),t.outputBuffers.positions.push(-t.sourceBuffers.positions[t.facePositionIndexes[e*3]]),t.outputBuffers.positions.push(t.sourceBuffers.positions[t.facePositionIndexes[e*3+1]]),t.outputBuffers.positions.push(t.sourceBuffers.positions[t.facePositionIndexes[e*3+2]]);const a=t.outputBuffers.indices.length;t.outputBuffers.indices.push(a),t.outputBuffers.indices.push(a+1),t.outputBuffers.indices.push(a+2),t.sourceBuffers.normals&&(t.outputBuffers.normals.push(-t.faceNormals[0]),t.outputBuffers.normals.push(t.faceNormals[1]),t.outputBuffers.normals.push(t.faceNormals[2]),t.outputBuffers.normals.push(-t.faceNormals[(e-1)*3]),t.outputBuffers.normals.push(t.faceNormals[(e-1)*3+1]),t.outputBuffers.normals.push(t.faceNormals[(e-1)*3+2]),t.outputBuffers.normals.push(-t.faceNormals[e*3]),t.outputBuffers.normals.push(t.faceNormals[e*3+1]),t.outputBuffers.normals.push(t.faceNormals[e*3+2])),t.sourceBuffers.uvs&&(t.outputBuffers.uvs.push(t.faceUVs[0]),t.outputBuffers.uvs.push(t.faceUVs[1]),t.outputBuffers.uvs.push(t.faceUVs[(e-1)*2]),t.outputBuffers.uvs.push(t.faceUVs[(e-1)*2+1]),t.outputBuffers.uvs.push(t.faceUVs[e*2]),t.outputBuffers.uvs.push(t.faceUVs[e*2+1])),t.materialIndex!==void 0&&(t.outputBuffers.materialIndices.push(t.materialIndex),t.outputBuffers.materialIndices.push(t.materialIndex),t.outputBuffers.materialIndices.push(t.materialIndex)),t.sourceBuffers.skeleton&&(t.outputBuffers.matricesWeights.push(t.faceWeights[0]),t.outputBuffers.matricesWeights.push(t.faceWeights[1]),t.outputBuffers.matricesWeights.push(t.faceWeights[2]),t.outputBuffers.matricesWeights.push(t.faceWeights[3]),t.outputBuffers.matricesWeights.push(t.faceWeights[(e-1)*4]),t.outputBuffers.matricesWeights.push(t.faceWeights[(e-1)*4+1]),t.outputBuffers.matricesWeights.push(t.faceWeights[(e-1)*4+2]),t.outputBuffers.matricesWeights.push(t.faceWeights[(e-1)*4+3]),t.outputBuffers.matricesWeights.push(t.faceWeights[e*4]),t.outputBuffers.matricesWeights.push(t.faceWeights[e*4+1]),t.outputBuffers.matricesWeights.push(t.faceWeights[e*4+2]),t.outputBuffers.matricesWeights.push(t.faceWeights[e*4+3]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[0]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[1]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[2]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[3]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[(e-1)*4]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[(e-1)*4+1]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[(e-1)*4+2]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[(e-1)*4+3]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[e*4]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[e*4+1]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[e*4+2]),t.outputBuffers.matricesIndices.push(t.faceWeightIndices[e*4+3]))}}static _ParseUvs(t){if(!t)return;const e=t.node("MappingInformationType")?.prop(0,"string"),a=t.node("ReferenceInformationType")?.prop(0,"string"),u=t.node("UV")?.prop(0,"number[]");let o=[];return a==="IndexToDirect"&&(o=t.node("UVIndex").prop(0,"number[]")),{buffer:u,indices:o,dataSize:2,mappingType:e,referenceType:a}}static _ParseNormals(t){if(!t)return;const e=t.node("MappingInformationType").prop(0,"string"),a=t.node("ReferenceInformationType").prop(0,"string"),u=t.node("Normals").prop(0,"number[]");let o=[];return a==="IndexToDirect"&&(o=(t.node("NormalIndex")??t.node("NormalsIndex")).prop(0,"number[]")),{buffer:u,indices:o,dataSize:3,mappingType:e,referenceType:a}}static _ParseMaterials(t){if(!t)return;const e=t.node("MappingInformationType").prop(0,"string");if(e==="AllSame")return;const a=t.node("ReferenceInformationType").prop(0,"string");if(e==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:a};const u=t.node("Materials").prop(0,"number[]"),o=[];for(let d=0;d<u.length;++d)o.push(d);return{buffer:u,dataSize:1,indices:o,mappingType:e,referenceType:a}}static _GetData(t,e,a,u){let o=t;switch(u.mappingType){case"ByPolygonVertex":o=t;break;case"ByPolygon":o=e;break;case"ByVertice":o=a;break;case"AllSame":o=u.indices[0];break}u.referenceType==="IndexToDirect"&&(o=u.indices[o]);var d=o*u.dataSize,h=d+u.dataSize;return this._Slice(u.buffer,d,h)}static _Slice(t,e,a){const u=[];for(var o=e,d=0;o<a;o++,d++)u[d]=t[o];return u}}class ko{static _SupportedTextureTypes=[".png",".jpg",".jpeg",".bmp"];static ParseMaterials(t){const e=this._ParseVideos(t.scene,t.objects,t.rootUrl,t.writeTextures),a=this._ParseTextures(t.objects,t.connections,e),u=t.objects.nodes("Material");for(const o of u){const d=o.prop(0,"number"),h=o.prop(1,"string"),k=new G.StandardMaterial(h,t.scene);k.id=d.toString(),t.result.materials.push(k),(o.node("Properties70")?.nodes("P")??[]).forEach(v=>{switch(v.prop(0,"string")){case"Diffuse":case"DiffuseColor":k.diffuseColor=new G.Color3(v.prop(4,"number"),v.prop(5,"number"),v.prop(6,"number"));break;case"Specular":case"SpecularColor":k.specularColor=new G.Color3(v.prop(4,"number"),v.prop(5,"number"),v.prop(6,"number"));break;case"Ambient":case"AmbientColor":k.ambientColor=new G.Color3(v.prop(4,"number"),v.prop(5,"number"),v.prop(6,"number"));break;case"Emissive":case"EmissiveColor":k.emissiveColor=new G.Color3(v.prop(4,"number"),v.prop(5,"number"),v.prop(6,"number"));break}}),t.connections.get(d)?.children?.forEach(v=>{const I=a[v.id];if(!I)return;switch(v.relationship){case"DiffuseColor":case"Maya|TEX_color_map":k.diffuseTexture=I;break;case"Bump":case"NormalMap":case"Maya|TEX_normal_map":k.bumpTexture=I;break;case"SpecularColor":k.specularTexture=I;break;case"Maya|TEX_ao_map":k.ambientTexture=I;break}}),t.cachedMaterials[d]=k}}static _ParseTextures(t,e,a){const u={},o=t.nodes("Texture");for(const d of o){const h=d.prop(0,"number"),k=e.get(h)?.children[0]?.id;if(k===void 0)continue;const g=a[k];if(!g)continue;u[h]=g;const f=d.node("ModelUVTranslation");f&&(g.uOffset=f.prop(0,"number")??0,g.vOffset=f.prop(1,"number")??0);const v=d.node("ModelUVScaling");v&&(g.uScale=v.prop(0,"number")??1,g.vScale=v.prop(1,"number")??1)}return u}static _ParseVideos(t,e,a,u){const o=e.nodes("Video"),d={};for(const h of o){let k=h.node("RelativeFilename")?.prop(0,"string")??h.node("Filename")?.prop(0,"string");if(!k)continue;k=k.replace(/\\/g,"/");const g=un(k).toLowerCase();if(this._SupportedTextureTypes.indexOf(g)===-1)continue;const f=h.prop(0,"number"),v=h.node("UseMipMap")?.prop(0)??0,I=Xi(k);let m=At(a,I);const D=h.node("Content")?.prop(0);if(!_t.isBuffer(D)||!D.length)continue;D.length&&(u?console.log("UNHANDLED: Write texture for video node"):(m="data:application/octet-stream;base64,",m+=_t.from(D).toString("base64")));const R=new G.Texture(m,t,!v,void 0,void 0,void 0);d[f]=R}return d}}class vo{static ParseAnimationGroups(t){if(!t.objects.nodes("AnimationCurve").length)return;const a=this._PrepareAnimationCurves(t.objects);this._ParseAnimationCurves(t.objects,t.connections,a);const u=this._ParseAnimationLayers(t.objects,t.connections,t.cachedModels,t.cachedSkeletons,a),o=this._ParseAnimationStacks(t.objects,t.connections,u);return this._CreateAnimationGroups(t,o)}static _CreateAnimationGroups(t,e){e.forEach(a=>{const u=new G.AnimationGroup(a.name,t.scene);t.result.animationGroups.push(u),a.layers.forEach(o=>{this._AddClip(u,o,t.cachedModels,t.cachedSkeletons)})})}static _AddClip(t,e,a,u){const o=this._GetTargets(e.modelId,a,u);if(!o.length)return;let d=G.Vector3.Zero(),h=G.Quaternion.Identity(),k=G.Vector3.One();e.transform&&e.transform.decompose(k,h,d);let g=k.asArray(),f=d.asArray(),v=h.toEulerAngles().asArray();if(e.T&&Object.keys(e.T.curves).length>0){const I=e.T.curves,m=this._GetTimes(I),D=this._GetKeyFrameAnimationValues(m,I,f);D.forEach(R=>R.x=-R.x),o.forEach(R=>{const T=new G.Animation(`${R.name}.position`,"position",1,G.Animation.ANIMATIONTYPE_VECTOR3,G.Animation.ANIMATIONLOOPMODE_CYCLE,!1);T.setKeys(m.map((U,Z)=>({frame:U,value:D[Z]}))),t.addTargetedAnimation(T,R)})}if(e.R&&Object.keys(e.R.curves).length>0){const I=e.R.curves;I.x&&(this._InterpolateRotations(I.x),I.x.values=I.x.values.map(T=>G.Tools.ToRadians(T))),I.y&&(this._InterpolateRotations(I.y),I.y.values=I.y.values.map(T=>G.Tools.ToRadians(T))),I.z&&(this._InterpolateRotations(I.z),I.z.values=I.z.values.map(T=>G.Tools.ToRadians(T)));const m=this._GetTimes(I),R=this._GetKeyFrameAnimationValues(m,I,v).map(T=>{let U;const Z=e.preRotation,N=e.postRotation;if(Z||N){if(U=Oe.GetFinalRotationQuaternionFromVector(T),Z&&(U=Oe.GetFinalRotationQuaternionFromVector(Z).multiply(U)),N){const E=Oe.GetFinalRotationQuaternionFromVector(N);U=U.multiply(G.Quaternion.Inverse(E))}}else U=Oe.GetFinalRotationQuaternionFromVector(T);return U});o.forEach(T=>{const U=new G.Animation(`${T.name}.rotationQuaternion`,"rotationQuaternion",1,G.Animation.ANIMATIONTYPE_QUATERNION,G.Animation.ANIMATIONLOOPMODE_CYCLE,!1);U.setKeys(m.map((Z,N)=>{const E=R[N];return{frame:Z,value:E}})),t.addTargetedAnimation(U,T)})}if(e.S&&Object.keys(e.S.curves).length>0){const I=e.S.curves,m=this._GetTimes(I),D=this._GetKeyFrameAnimationValues(m,I,g);o.forEach(R=>{const T=new G.Animation(`${R.name}.scaling`,"scaling",1,G.Animation.ANIMATIONTYPE_VECTOR3,G.Animation.ANIMATIONLOOPMODE_CYCLE,!1);T.setKeys(m.map((U,Z)=>({frame:U,value:D[Z]}))),t.addTargetedAnimation(T,R)})}}static _InterpolateRotations(t){const e=(a,u,o)=>a.slice(0,u).concat(o).concat(a.slice(u));for(let a=1;a<t.values.length;a++){const u=t.values[a-1],o=t.values[a]-u,d=Math.abs(o);if(d>=180){const h=d/180,k=o/h;let g=u+k;const f=t.times[a-1],I=(t.times[a]-f)/h;let m=f+I;const D=[],R=[];for(;m<t.times[a];)D.push(m),m+=I,R.push(g),g+=k;t.times=e(t.times,a,D),t.values=e(t.values,a,R)}}}static _GetKeyFrameAnimationValues(t,e,a){const u=[],o=a;let d=-1,h=-1,k=-1;t.forEach(function(f){if(e.x&&(d=e.x.times.indexOf(f)),e.y&&(h=e.y.times.indexOf(f)),e.z&&(k=e.z.times.indexOf(f)),d!==-1){const v=e.x.values[d];u.push(v),o[0]=v}else u.push(o[0]);if(h!==-1){const v=e.y.values[h];u.push(v),o[1]=v}else u.push(o[1]);if(k!==-1){const v=e.z.values[k];u.push(v),o[2]=v}else u.push(o[2])});const g=[];for(let f=0;f<u.length;f+=3)g.push(new G.Vector3(u[f],u[f+1],u[f+2]));return g}static _GetTimes(t){let e=[];if(t.x!==void 0&&(e=e.concat(t.x.times)),t.y!==void 0&&(e=e.concat(t.y.times)),t.z!==void 0&&(e=e.concat(t.z.times)),e=e.sort((a,u)=>a-u),e.length>1){let a=1,u=e[0];for(let o=1;o<e.length;o++){const d=e[o];d!==u&&(e[a]=d,u=d,a++)}e=e.slice(0,a)}return e}static _ParseAnimationStacks(t,e,a){const u=new Map,o=t.nodes("AnimationStack");for(const d of o){const h=d.prop(0,"number"),k=e.get(h)?.children;if(!k)continue;const g=a.get(k[0].id);g&&u.set(h,{layers:g,name:d.prop(1,"string")})}return u}static _ParseAnimationLayers(t,e,a,u,o){const d=new Map,h=t.nodes("AnimationLayer");for(const k of h){const g=k.prop(0,"number"),f=[],v=e.get(g);v?.children.length&&(v.children.forEach((I,m)=>{const D=o.get(I.id);if(D&&!(!D.curves.x&&!D.curves.y&&!D.curves.z)){if(!f[m]){const R=e.get(I.id).parents.filter(function(T){return T.relationship!==void 0})[0].id;if(R!==void 0){const T=t.nodes("Model").find(V=>V.prop(0,"number")===R);if(!T)return;const U=T.prop(0,"number"),Z=T.prop(1,"string"),N=this._GetTargets(U,a,u)[0];let E=G.Matrix.Identity();N&&(N instanceof G.Bone?E=N.getRestPose().clone():N instanceof G.TransformNode&&(E=N._localMatrix.clone()));const O=T.node("Properties70")?.nodes("P");let C,$;if(O?.length){const V=O.find(q=>q.prop(0,"string")==="PreRotation"),H=O.find(q=>q.prop(0,"string")==="PostRotation");V&&(C=new G.Vector3(G.Tools.ToRadians(V.prop(4,"number")??0),G.Tools.ToRadians(V.prop(5,"number")??0),G.Tools.ToRadians(V.prop(6,"number")??0))),H&&($=new G.Vector3(G.Tools.ToRadians(H.prop(4,"number")??0),G.Tools.ToRadians(H.prop(5,"number")??0),G.Tools.ToRadians(H.prop(6,"number")??0)))}const X={modelId:R,transform:E,modelName:Z,preRotation:C,postRotation:$,id:U,eulerOrder:N?.metadata?.transformData?.eulerOrder??"ZYX"};f[m]=X}}f[m]&&(f[m][D.attrName]=D)}}),d.set(g,f))}return d}static _GetTargets(t,e,a){const u=e[t];if(u&&u instanceof G.TransformNode)return[u];const o=[];for(const d in a){const k=a[d].skeletonInstance.bones.find(g=>g.id===t.toString());k&&o.push(k)}return o}static _ParseAnimationCurves(t,e,a){const u=t.nodes("AnimationCurve");for(const o of u){const h={id:o.prop(0,"number"),times:o.node("KeyTime").prop(0,"number[]").map(I=>I/46186158e3),values:o.node("KeyValueFloat").prop(0,"number[]")},k=e.get(h.id);if(!k?.parents?.[0].relationship)continue;const g=k.parents[0].id,f=k.parents[0].relationship,v=a.get(g);v&&(f.match(/X/)?v.curves.x=h:f.match(/Y/)?v.curves.y=h:f.match(/Z/)?v.curves.z=h:f.match(/d|DeformPercent/)&&a.has(g)&&(v.curves.morph=h))}}static _PrepareAnimationCurves(t){const e=new Map,a=t.nodes("AnimationCurveNode");return a.length&&a.forEach(u=>{const o=u.prop(1,"string").replace("AnimCurveNode::","");if(o.match(/S|R|T|DeformPercent/)!==null){const d=u.prop(0,"number");e.set(d,{id:d,attrName:o,curves:{}})}}),e}}class Mt{static ParseTransform(t,e){const a=e.node("Properties70");if(a){const u={eulerOrder:"ZYX"};a.nodes("P").forEach(d=>{const h=d.prop(0,"string"),k=d.prop(4,"number")??0,g=d.prop(5,"number")??0,f=d.prop(6,"number")??0;switch(h){case"RotationOrder":u.eulerOrder=d.prop(4,"string")??u.eulerOrder;break;case"InheritType":u.inheritType=d.prop(4,"number");break;case"Lcl Translation":u.translation=new G.Vector3(-k,g,f);break;case"PreRotation":u.preRotation=new G.Vector3(G.Tools.ToRadians(k),G.Tools.ToRadians(g),G.Tools.ToRadians(f));break;case"Lcl Rotation":u.rotation=new G.Vector3(G.Tools.ToRadians(k),G.Tools.ToRadians(g),G.Tools.ToRadians(f));break;case"PostRotation":u.postRotation=new G.Vector3(G.Tools.ToRadians(k),G.Tools.ToRadians(g),G.Tools.ToRadians(f));break;case"RotationOffset":break;case"RotationPivot":break;case"Lcl Scaling":u.scaling=new G.Vector3(k,g,f);break}}),t.metadata??={},t.metadata.transformData=u}}static ApplyTransform(t){const e=t.metadata?.transformData;if(!e)return;const a=e.scaling??t.scaling,u=e.translation??t.position;let o=G.Quaternion.Identity();if(e.rotation&&(o=Oe.GetFinalRotationQuaternionFromVector(e.rotation)),e.preRotation&&(o=Oe.GetFinalRotationQuaternionFromVector(e.preRotation).multiply(o)),e.postRotation){const d=Oe.GetFinalRotationQuaternionFromVector(e.postRotation);o=o.multiply(G.Quaternion.Inverse(d))}t.scaling=a,t.position=u,t.rotationQuaternion=o,delete t.metadata.transformData}static GetTransformData(t){const e=t.metadata?.transformData;return e||{eulerOrder:"ZYX"}}}class fn{static ParseRawSkeletons(t){for(const e of t.deformers){const a=e.prop(0,"number"),u=e.prop(2,"string"),o=t.connections.get(a);if(u==="Skin"){const d=e.prop(0,"number"),h=e.prop(1,"string");if(!t.cachedSkeletons[d]){const g=t.deformers.filter(v=>o?.children.find(I=>I.id===v.prop(0,"number"))),f=this._GetRawSkeleton(d,h,g,t.scene);t.cachedSkeletons[d]=f,t.result.skeletons.push(f.skeletonInstance)}}}}static _GetRawSkeleton(t,e,a,u){const o=[];a.forEach(h=>{if(h.prop(2,"string")!=="Cluster")return;const k={id:h.prop(0,"number"),indices:h.node("Indexes")?.prop(0,"number[]")??[],weights:h.node("Weights")?.prop(0,"number[]")??[],transform:G.Matrix.FromArray(h.node("Transform").prop(0,"number[]")),transformLink:G.Matrix.FromArray(h.node("TransformLink").prop(0,"number[]"))};o.push(k)});const d=new G.Skeleton(e,0,u);return{id:t,rawBones:o,bones:[],skeletonInstance:d}}static CheckSkeleton(t,e,a,u){u.parents.forEach(o=>{for(const d in t.cachedSkeletons){const h=t.cachedSkeletons[d];h.rawBones.forEach((k,g)=>{if(k.id!==o.id)return;const f=e.prop(0,"number").toString(),v=`${h.skeletonInstance.name}-${a}`;if(h.skeletonInstance.bones.find(m=>m.name===v))return;const I=new G.Bone(v,h.skeletonInstance);I.id=f,I._index=g,Mt.ParseTransform(I,e),I.metadata.connections=u,h.bones[g]=I})}})}static BindSkeletons(t){const e={};t.objects.nodes("Pose").forEach(u=>{u.nodes("PoseNode").forEach(d=>{const h=d.node("Node").prop(0,"number"),k=d.node("Matrix").prop(0,"number[]");e[h]=G.Matrix.FromArray(k)})});for(const u in t.cachedSkeletons){const o=t.cachedSkeletons[u];for(const h of o.skeletonInstance.bones){const k=h._index??-1;if(!o.rawBones[k])continue;h.metadata.connections?.parents.forEach(v=>{const I=o.skeletonInstance.bones.find(m=>m.id===v.id.toString());I&&h.setParent(I)}),Mt.ApplyTransform(h),h.setRestMatrix(h.getLocalMatrix()),h.updateMatrix(h.getLocalMatrix(),!1,!1),h._updateAbsoluteBindMatrices(void 0,!0)}t.connections.get(parseInt(u))?.parents?.forEach(h=>{t.connections.get(h.id)?.parents?.forEach(g=>{const f=t.cachedModels[g.id];if(f&&f instanceof G.AbstractMesh){const v=e[g.id];v&&!v.isIdentity()&&(f.updatePoseMatrix(v),o.skeletonInstance.needInitialSkinMatrix=!0),f.skeleton=o.skeletonInstance,f.skeleton.bones.forEach(I=>{I.name=`${f.name}-${I.name}`})}})})}}}class Di{static ParseConnections(t){const e=t.nodes("C"),a=new Map;return e.forEach(u=>{const o=u.prop(1,"number"),d=u.prop(2,"number"),h=u.prop(3,"string");a.has(o)||a.set(o,{parents:[],children:[]}),a.get(o)?.parents.push({id:d,relationship:h}),a.has(d)||a.set(d,{parents:[],children:[]}),a.get(d)?.children.push({id:o,relationship:h})}),a}}class Io{constructor(t=!1){this.writeTextures=t}name="FBX Loader";extensions={".fbx":{isBinary:!0}};async importMeshAsync(t,e,a,u,o,d){const h=await this.loadAssetContainerAsync(e,a,u,o,d);return h.addAllToScene(),{lights:h.lights,meshes:h.meshes,skeletons:h.skeletons,geometries:h.geometries,transformNodes:h.transformNodes,animationGroups:h.animationGroups,particleSystems:h.particleSystems,spriteManagers:[]}}async loadAsync(t,e,a,u,o){(await this.loadAssetContainerAsync(t,e,a,u,o)).addAllToScene()}async loadAssetContainerAsync(t,e,a,u,o){const d=new G.AssetContainer(t);t._blockEntityCollection=!0,console.log(e);let h;try{h=io(_t.from(e))}catch(T){console.warn(T);try{h=Ui.parseText(_t.from(e).toString("utf-8"))}catch{return G.Logger.Error("Can't parse FBX file. format is unknown or unsupported."),d}}const k=new Ui.FBXReader(h),g=k.node("FBXHeaderExtension")?.node("FBXVersion")?.prop(0,"number")??0;if(g<7e3)return G.Logger.Warn(`Can't parse FBX: version (${g}) not supported. FBX Loader supports versions >= 7000.`),d;const f=k.node("Objects");if(!f)return d;const v=Di.ParseConnections(k.node("Connections")),I=f.nodes("Model");if(!I)return d;const m=f.nodes("Deformer"),D=f.nodes("Geometry").filter(T=>T.prop(2,"string")==="Mesh"),R={scene:t,result:d,rootUrl:a,filePath:At(Hi(a,o??"")),models:I,objects:f,deformers:m,geometries:D,writeTextures:this.writeTextures,cachedModels:{},cachedSkeletons:{},cachedMaterials:{},cachedGeometries:{},connections:Di.ParseConnections(k.node("Connections"))};ko.ParseMaterials(R),fn.ParseRawSkeletons(R),Eo.ParseGeometries(R);for(const T of I){const U=T.prop(0,"number"),Z=T.prop(2,"string"),N=T.prop(1,"string"),E=v.get(U);if(!E)continue;fn.CheckSkeleton(R,T,N,E);let S=null;switch(Z){case"Mesh":S=xo.CreateMesh(R,T,E);break;case"Light":case"Camera":case"NurbsCurve":break;case"Root":case"LimbNode":break;case"Null":default:S=new G.TransformNode(N,t,!0),d.transformNodes.push(S);break}S&&(R.cachedModels[U]=S,Mt.ParseTransform(S,T))}for(const T in R.cachedModels){const U=parseInt(T),Z=R.cachedModels[T];v.get(U)?.parents?.forEach(E=>{const S=R.cachedModels[E.id];S&&(Z.parent=S)}),Z.computeWorldMatrix(!0)}for(const T in R.cachedModels){const U=R.cachedModels[T];Mt.ApplyTransform(U)}return fn.BindSkeletons(R),vo.ParseAnimationGroups(R),t._blockEntityCollection=!1,d}}class Ao{name="fbx";extensions={".fbx":{isBinary:!0}};createPlugin(){return new Io}}nt.FBXLoader=Ao,nt.FBXUtils=Oe,Object.defineProperty(nt,Symbol.toStringTag,{value:"Module"})}));
